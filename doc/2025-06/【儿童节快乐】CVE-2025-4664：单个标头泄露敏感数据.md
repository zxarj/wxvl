#  【儿童节快乐】CVE-2025-4664：单个标头泄露敏感数据   
原创 破天KK  KK安全说   2025-05-31 16:00  
  
上周，谷歌修补了Chrome 中一个已被广泛利用的**高危漏洞。该漏洞编号为****CVE-2025-4664**，影响 Chrome 的**加载器组件**，攻击者可能利用Link 标头中的巧妙小技巧**窃取其他网站的敏感数据**。****  
  
  
让我们简单解释一下它的工作原理以及它的重要性。  
# 步骤 1：有缺陷的组件 — Chrome 的加载器  
  
Chrome 的**加载器**负责处理各种 Web 资源（例如图片、脚本或样式表）的获取和渲染方式。遗憾的是，在**136.0.7103.113**之前的版本中，加载器对某些策略的执行不够严格，尤其是在**跨域数据**方面。  
  
这就是事情开始变得扑朔迷离的地方。  
# 步骤 2：技巧——滥用链接标头  
  
攻击者创建一个**恶意 HTML 页面**，在子资源请求中包含一个特殊的**Link 标头**。目前，大多数浏览器并不会过多关注此类请求中的 Link 标头，**但 Chrome 浏览器会**。  
  
这是第一个转折。  
# 步骤3：设置陷阱——滥用Referrer-Policy  
  
通过该 Link 标头，攻击者设置了类似的**referrer-policy**unsafe-url。这会告诉 Chrome在向第三方资源（如图像）发出请求时，在 HTTP Referrer 标头中包含**完整的 URL，包括敏感的查询参数。**  
  
想象一下，您的登录会话、密码重置令牌或个人信息被整齐地塞在 URL 中 — — 现在这些数据被发送**到攻击者控制的服务器**。  
# 步骤4：数据泄露——只需加载图像  
  
攻击者嵌入了一个指向其自身服务器的**隐藏图像标签。当 Chrome 获取该图像时，它会包含用户所访问页面的完整 URL（以及敏感的查询字符串），从而有效地****将私人数据泄露**给攻击者。  
  
无需复杂的恶意软件或社会工程学。只需访问攻击者的页面即可实现。  
# 哪些信息可能被泄露？  
- **登录令牌**  
- **会话标识符**  
- **URL 中的敏感表单数据**  
- **包含电子邮件或个人信息的查询字符串**  
更糟糕的是，如果这些值可以被重复使用（例如会话令牌），攻击者就可以执行**完全帐户接管**。  
# 您现在应该做什么  
  
Google 行动迅速。如果您是 Chrome 用户，请立即更新：  
  
✅ Windows 和 Mac 版**Chrome 136.0.7103.113/.114**  
✅ Linux 版**136.0.7103.113**  
  
如果您使用的是**Edge、Brave、Vivaldi**或其他基于 Chromium 的浏览器，请留意更新。这些浏览器可能会继承相同的漏洞，直到修复为止。  
# 最后的想法  
  
这并非那种点击一下就能成功的漏洞，但它**巧妙、悄无声息且威力十足**，尤其适用于定向攻击。这提醒我们，即使是看似“微不足道”的标头和策略，如果被忽视，也可能成为重大的安全风险。  
  
它还展示了像**Vsevolod Kokorin**这样知识渊博的研究人员如何发现微妙但危险的缺陷。  
  
如果您是开发人员，请考虑**尽量减少 URL 中的敏感数据**- 并**依靠 POST 方法和标头来**获取关键信息。  
  
如果你是用户，只需保持浏览器更新即可。这是确保在线安全的最简单方法之一。  
  
  
