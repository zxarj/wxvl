#  Evertz SDVN 上的远程代码执行 (CVE-2025-4009)   
 Ots安全   2025-06-02 06:28  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
> EVERTZ SDVN是一种基于IP的架构，旨在帮助广播设施、内容提供商和服务提供商构建灵活、可扩展且格式无关的基础设施。它通过软件定义网络（SDN）的理念，将视频、音频和数据的传输从传统的硬件依赖转向更灵活的IP网络。这种技术能够支持从标清（SD）、高清（HD）、3G到超高清（Ultra HD，包括4K和8K）的多种视频格式，同时满足生产、播放和广域网（WAN）分发的需求。  
  
  
自 ONEKEY 研究实验室成立以来，我们已与 20 多家供应商协调了近 50 个不同漏洞的披露。虽然由于受影响设备的特殊性，我们有时不得不同意延长截止日期，但我们从未因为供应商未答复而被迫进行全面披露。直到今天。  
  
我们尝试通过不同渠道（电子邮件、LinkedIn、Twitter）向 Evertz 报告此未经身份验证的命令注入漏洞，并最终向 CERT.CC 提交了案例，但尚未收到任何回复。因此，我们今天（2025 年 5 月 28 日）发布了详细信息，比 90 天截止日期（2025 年 5 月 26 日）晚了两天。  
  
Evertz 在广播行业中无处不在，我们认为我们有责任让这些网络的管理员意识到这种缺陷几乎影响了 Evertz 的所有产品线，因为它影响了所有设备共享的 Web 管理界面的核心。  
  
概括  
  
Evertz SDVN 3080ipx-10G 是一款用于视频应用的高带宽以太网交换架构。该设备在 80 端口上提供 Web 管理界面。管理员可以使用该 Web 管理界面控制产品功能、设置网络交换、注册许可证等。该应用程序采用 PHP 开发，使用了 webEASY SDK（Evertz 也将其命名为“ewb”）。  
  
该 Web 界面有两个端点易受任意命令注入攻击，并且身份验证机制存在导致身份验证绕过的缺陷。  
  
影响  
  
未经身份验证的远程攻击者可以在受影响的设备上以提升的权限（root）执行任意命令。  
  
这种级别的访问可能会导致严重的业务影响，例如媒体流中断、正在流式传输的媒体被修改、正在生成的隐藏字幕被更改等等。  
  
描述  
  
文件usr/htdocs/v.1.5/php/features/feature-transfer-import.php根据用户控制的参数action、filename和slot构建一个命令：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48taemVJjguRkiaBQ4HGr5Upv5xZbd7kVbtCdOSpvibkMrnbytMFajkLr3CJicMlQNAgq6pEMSUbw7gmpXQ/640?wx_fmt=png&from=appmsg "")  
  
由于未应用任何清理措施，因此可以通过发送如下请求进行任意命令注入：  
  
```
curl'http ://ip.of.device/v.1.5/php/features/feature-transfer-import.php?action=id;&filename=&varid=&slot='
```  
  
  
类似地，文件usr/htdocs/v.1.5/php/features/feature-transfer-export.php根据用户控制的参数action、filename和slot构建一个命令：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48taemVJjguRkiaBQ4HGr5Upv5xQIrUOibMTsmkk3o9DDmk313ibmc5Xw2m7pHRTUwsZKJich8shC2MaJeeA/640?wx_fmt=png&from=appmsg "")  
  
由于未应用任何清理措施，因此可以通过发送如下请求进行任意命令注入：  
  
```
curl 'http://ip.of.device/v.1.5/php/features/feature-transfer-export.php?action=id;&filename=&varid=&slot='
```  
  
  
虽然利用仅限于经过身份验证的用户，但我们已经找到了一种绕过身份验证的方法。  
  
在usr/htdocs/login.php中，可以观察到以下逻辑：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48taemVJjguRkiaBQ4HGr5Upv5xedNDseNhbkLtqbYUwZEEKXBAQtlFJMc4ulTJwJicpK7zk9VFTzLEgUg/640?wx_fmt=png&from=appmsg "")  
  
预授权用户？这是什么？  
  
因此，如果用户发送带有授权 GET 参数的请求，则会调用parseAuthorizedUsers函数。该函数需要 JSON 结构或 base64 编码的 JSON 结构。解析该结构后，系统会根据 JSON 结构中提供的数据创建一个具有角色的用户。该函数没有进行任何验证，更重要的是，没有身份验证检查，例如检查该参数是否由应用程序本身创建。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48taemVJjguRkiaBQ4HGr5Upv5x2cG34XiakrPNP7h8Tdoric3ZFVyWkV6INUOibIOWOo4GI4rb6xiaAjH2iaw/640?wx_fmt=png&from=appmsg "")  
  
因此，未经身份验证的用户可以通过制作有效的 base64 编码 JSON 结构来获得管理员访问权限，该结构代表具有不受限制角色的管理员用户。  
  
可以使用此 curl 命令实现身份验证绕过。我们可以从服务器响应中看到用户确实已通过身份验证。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48taemVJjguRkiaBQ4HGr5Upv5x9vPD9qzSOicpkt5qxOcofNx2HtD1wZiaslpQvDCwrsIy19R67FY43lvA/640?wx_fmt=png&from=appmsg "")  
  
确实易于登录  
  
通过结合身份验证绕过和命令注入，可以获得未经身份验证的任意命令注入。  
  
  
关键要点  
  
90 天内首次——在协调了 20 多家供应商的近 50 个漏洞后，这标志着我们首次公开披露——在 90 天期限后两天发布——完全是由于 Evertz 没有回应。  
  
未经身份验证的根级命令注入- Evertz 多个产品线中基于 PHP 的 webEASY（ewb）接口允许远程攻击者以 root 身份实现任意 shell 执行，这是因为两个功能端点接受未经清理的参数并结合了身份验证绕过。  
  
广泛的产品影响——所有共享易受攻击的 Web 管理核心的主要 Evertz 设备都面临着整个系统受到损害的风险。  
  
严重的商业后果——漏洞利用可能会破坏或操纵视频流、篡改隐藏字幕、中断广播操作，造成严重的运营和声誉损害。  
  
建议立即- 管理员应将 Evertz Web 管理界面与不受信任的网络隔离，应用网络级访问控制，并监控异常 Web 请求或 shell 生成进程，等待官方供应商补丁。  
  
  
时间线  
- 2025年2月25日- ONEKEY 向 Service@evertz.com 发送通知  
  
- 2025 年 2 月 28 日- ONEKEY 向 Service@evertz.com、info@evertz.com、security@evertz.com、psirt@evertz.com、support@evertz.com 发送通知  
  
- 2025 年 3 月 28 日- ONEKEY 向 Service@evertz.com、info@evertz.com、security@evertz.com、psirt@evertz.com、support@evertz.com、ukservice@evertz.com、sales@evertz.com、Vertrieb@evertz.com 发送提醒  
  
- 2025 年 4 月 10 日- ONEKEY 尝试通过 x.com 上的 @EvertzTV 帐户与 Evertz 取得联系  
  
- 2025 年 4 月 11 日- ONEKEY 向 Evertz 网络安全团队的不同 Linkedin 用户发送邮件  
  
- 2025 年 4 月 27 日- ONEKEY 向 CERT.CC 提交了关于 VINCE（漏洞信息和协调环境）的案件  
  
- 2025 年 5 月 28 日- ONEKEY 发布此公告  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
  
