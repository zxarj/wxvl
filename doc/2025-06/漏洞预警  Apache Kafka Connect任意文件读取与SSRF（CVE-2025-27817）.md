#  漏洞预警 | Apache Kafka Connect任意文件读取与SSRF（CVE-2025-27817）  
Enomothem  Eonian Sharp   2025-06-13 03:23  
  
# Apache Kafka（CVE-2025-27817）  
### 漏洞介绍  
  
Apache Kafka 是一款开源的分布式事件流平台，广泛用于高性能数据管道、流式分析和数据集成。  
  
Apache Kafka 客户端任意文件读取漏洞(CVE-2025-27817）攻击者可以利用该漏洞读取服务器上的任意文件内容，并将其返回到错误日志中，或者向非预期的地址发送请求。  
### 漏洞原理  
  
在 Apache Kafka 客户端 3.1.0 至 3.9.0 版本中，部分与认证相关的配置字段（如   
  
sasl.oauthbearer.token.endpoint.url  
）允许设置为 file://  
 协议  
。  
  
由于客户端未对该 URL 协议进行有效校验，导致可将本地文件内容作为 OAuth Token 加载——  
只要攻击者能够控制这些字段的值，即可触发漏洞  
  
  
  
。  
  
其中，  
Kafka Connect 是一个高危的漏洞触发场景  
：  
- 在分布式模式下，其默认暴露 REST API（端口 8083）；  
  
- 支持远程创建/修改连接器；  
  
可通过 JSON 请求直接注入恶意字段，如：  
```
"sasl.oauthbearer.token.endpoint.url": "file:///etc/passwd"
```  
- 配置支持动态生效，无需重启，极易被脚本化利用。  
  
这些特性叠加，使原本应仅影响客户端配置安全的问题  
，  
演变为一个可远程利用的任意文件读取漏洞  
  
，大大提升了攻击风险。  
### 影响版本  
  
影响版本  
```
3.1.0 <= Apache Kafka <= 3.9.0
```  
### 修复建议：  
  
  
建议用户尽快升级到以下或更高的安全版本  
  
：  
  
Apache Kafka 3.9.1  
  
Apache Kafka 4.0.0  
  
补丁链接：  
  
https://kafka.apache.org/downloads  
  
  
  
  
知识大陆618活动  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hvMQKkLOqzMFNWmNUmJ35gmO30EQrAGbNcIjt2JcG0TBMojJbC14mibRQ1Kzoj6S1YPFrbA1ZlX8VbOWKgSIHQQ/640?wx_fmt=png&from=appmsg "")  
  
  
ESPscan工具平台价格  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/hvMQKkLOqzMFNWmNUmJ35gmO30EQrAGbtqjNGKlictrian9SDbvtdvmMN1ibB6TeZ6ib6E6MoatC6kj770C64HsyEw/640?wx_fmt=png&from=appmsg "")  
  
https://m-wiki.freebuf.com/clubsStore/detail?id=58  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/hvMQKkLOqzNB0pYGByVnU6dQl2MwT7mYzDqQVbnnhibGA3Ck6OwoAMlKLyxGI84zhZHvQdHR57rDZqSHNlm7x5w/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
  
