#  【漏洞复现】Grafana XSS &SSRF & 账户接管（CVE-2025–4123）   
原创 安全探索者  安全探索者   2025-05-23 09:53  
  
↑点击关注，获取更多漏洞预警，技术分享  
  
0x01 组件介绍  
  
    
Grafana 是一个开源的分析平台，主要用 Go 和 TypeScript 构建，用于可视化来自 Prometheus 和 InfluxDB 等数据源的数据。  
  
搜索语法：app="Grafana"  
  
0x02 漏洞描述  
  
    Grafana中存在一个跨站点脚本（XSS）漏洞，该漏洞是由组合客户端路径遍历和打开重定向造成的。这使得攻击者能够将用户重定向到包含可执行任意JavaScript的前端插件的网站。此漏洞需要经过身份验证（匿名访问），XSS将起作用，如果安装了Grafana Image Renderer插件，就有可能利用打开的重定向来实现SSRF和接管账户。Grafana中默认的Content-Security-Policy（CSP）可通过connect-src  
指令阻止XSS。  
     
  
<table><tbody><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞分类</span></section></td><td colspan="3" data-colwidth="143,143,143" width="143,143,143" style="border-color:#0080ff;"><section><span leaf="">xss/ssrf</span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="" data-pm-slice="1 1 [&#34;table&#34;,{&#34;interlaced&#34;:null,&#34;align&#34;:null,&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_body&#34;,{},&#34;table_row&#34;,{&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_cell&#34;,{&#34;colspan&#34;:1,&#34;rowspan&#34;:1,&#34;colwidth&#34;:[143],&#34;width&#34;:null,&#34;valign&#34;:null,&#34;align&#34;:null,&#34;style&#34;:null},&#34;para&#34;,null]">CVSS 3.1分数</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">7.6</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞等级</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">高危</span></span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">POC/EXP</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""> </span><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">已公开</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">可利用性</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">低（需要身份验证）</span></span></section></td></tr></tbody></table>  
  
0x03 影响版本  
- Grafana ＜ 12.0.0-security-01  
  
- Grafana ＜ 11.6.1-security-01  
  
- Grafana ＜ 11.5.4-security-01  
  
- Grafana ＜ 11.4.4-security-01  
  
- Grafana ＜ 11.3.6-security-01  
  
- Grafana ＜ 11.2.9-security-01  
  
- Grafana ＜ 10.4.18-security-01  
  
<table><tbody><tr style="-webkit-tap-highlight-color: transparent;outline: 0px;visibility: visible;"></tr></tbody></table>  
  
0x04 漏洞验证  
  
目前POC/EXP已经公开(  
后台留言：  
CVE-2025–4123  
，获取测试POC  
)  
  
概念性验证：  
  
发送数据包，出现下面的即可证明漏洞存在  
  
具体过程参考：  
  
https://medium.com/@Nightbloodz/grafana-cve-2025-4123-full-read-ssrf-account-takeover-d12abd13cd53  
  
以下为  
漏洞发现作者复现  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3epfkcSYUMZKHo1lYiaiaRG2Z2TbHMARAVSprscibqkqmib0RmCU73ja5WsKYNhfYwibicYarqXg9AcqtKbg/640?wx_fmt=png&from=appmsg "")  
  
  
  
0x05 漏洞影响  
  
由于该漏洞影响范围较广，危害较大。通过以上复现过程，我们可以知道该漏洞的利用过程比较困难，  
需要经过身份验证（开启匿名访问），且能造成的危害是高危的，可以造成ssrf 甚至可接管账号。企业应该尽快排查是否有使用该组件，并尽快做出对应措施  
  
  
0x06 修复建议  
  
目前官方已发布了相关安全版本或补丁，受影响用户可下载安装。  
  
https://grafana.com/  
  
https://github.com/grafana/grafana  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3epfkcSYUMZKHo1lYiaiaRG2Z2FPny5Jib4Z8zDicWXxyz7BycsiaIj1WpJdRdguDzolQkFVgvvWnhAmnHg/640?wx_fmt=png&from=appmsg "")  
  
0X07 参考链接  
  
  
https://medium.com/@Nightbloodz/grafana-cve-2025-4123-full-read-ssrf-account-takeover-d12abd13cd53  
  
https://grafana.com/security/security-advisories/cve-2025-4123/  
  
  
0x08 免责声明  
  
> 本文所涉及的任何技术、信息或工具，仅供学习和参考之用。  
  
> 请勿利用本文提供的信息从事任何违法活动或不当行为。任何因使用本文所提供的信息或工具而导致的损失、后果或不良影响，均由使用者个人承担责任，与本文作者无关。  
  
> 作者不对任何因使用本文信息或工具而产生的损失或后果承担任何责任。使用本文所提供的信息或工具即视为同意本免责声明，并承诺遵守相关法律法规和道德规范。  
  
  
  
