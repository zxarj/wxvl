#  CVE-2024-6235 PoC NetScaler 控制台漏洞可导致管理员访问   
 TtTeam   2025-05-29 02:22  
  
Citrix NetScaler 控制台中的一个高危漏洞 CVE-2024-6235，发现该漏洞可导致严重的未经身份验证的会话劫持，攻击者可利用内部 API 创建管理员账户。虽然该漏洞被归类为“信息泄露”，但其实际影响远比此漏洞严重，CVSSv4 评分高达 9.4。  
  
该漏洞允许未经身份验证的攻击者从内部 API 获取管理员级别的会话 ID，并使用它在系统上创建其他管理员用户。  
  
Citrix 最初在其公告中提供了少量细节，仅提及 CWE-287：身份验证不当。Rapid7 的研究团队对已修复版本 (v14.1-29.63) 和存在漏洞的版本 (v14.1-8.50) 进行了逆向工程，最终发现了问题的核心：一个内部 API 端点在未经适当身份验证的情况下泄露了管理会话令牌。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB17nS4dYM3P7QR47J1WVjtFmpmQzwljFDNFKFDsAibB7RxiaaX5ibKicfI3HtFKCaGybQLGtwZPicibWQgw/640?wx_fmt=png&from=appmsg "")  
  
GET 请求到：/internal/v2/config/mps_secret/ADM_SESSIONID 以及标头：  
  
```
Tenant-Name: Owner
User-Name: nsroot
Mps-Internal-Request: true
```  
  
  
攻击者可以获得授予完全管理员权限的活动会话令牌。  
从NetScaler管理面板HTML中获取了另一个必需参数rand_key。在这两个部分到位后，他们成功创建了一个新的管理员用户。安全研究人员成功开发了一个概念验证（PoC）脚本来自动化漏洞利用过程。该脚本从内部API检索会话ID，获取rand_key，并创建一个新的超级管理员用户。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/0HlywncJbB17nS4dYM3P7QR47J1WVjtFFsicn3H25VkP14dZunbF3eCRFN61hkbcAAZad6aGYic28ibHCgGrVK3dQ/640?wx_fmt=png&from=appmsg "")  
  
Citrix 已在 2024 年 7 月发布的 NetScaler 控制台版本 14.1-25.53 中修复了此漏洞。强烈建议使用易受攻击版本的组织立即更新到已修复的版本，并实施强大的补丁管理策略。  
  
