#  【漏洞复现】vBulletin replaceAdTemplat 远程代码执行漏洞（CVE-2025-48827/48828)   
安全探索者  安全探索者   2025-05-28 11:03  
  
↑点击关注，获取更多漏洞预警，技术分享  
  
0x01 组件介绍  
  
  vBulletin 是互联网上最广泛使用的商业论坛解决方案之一，为从利基爱好者网站到大型科技论坛的数千个在线社区提供支持。它主要使用 PHP 开发，具有类似 MVC 的自定义框架和专有的 API 系统，用于处理 AJAX 和移动应用交互。  
  
搜索语法：app="vBulletin"  
  
  
0x02 漏洞描述  
  
     
2025年5月，互联网上披露vBulletin两个高危漏洞  
  
CVE-2025-48827：vBulletin 用于 protected API 控制器的方法调用漏洞；  
  
CVE-2025-48828： vBulletin 可能允许攻击者通过滥用模板引擎中的模板条件来执行任意 PHP 代码。攻击者可以通过创建使用替代 PHP 函数调用语法的模板代码，例如使用 "var_dump"("test") 语法，绕过安全检查并执行任意 PHP 代码。  
  
结合两个漏洞可以导致任意代码执行  
<table><tbody><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞分类</span></section></td><td colspan="3" data-colwidth="143,143,143" width="143,143,143" style="border-color:#0080ff;"><section><span leaf="">远程代码执行</span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="" data-pm-slice="1 1 [&#34;table&#34;,{&#34;interlaced&#34;:null,&#34;align&#34;:null,&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_body&#34;,{},&#34;table_row&#34;,{&#34;class&#34;:null,&#34;style&#34;:null},&#34;table_cell&#34;,{&#34;colspan&#34;:1,&#34;rowspan&#34;:1,&#34;colwidth&#34;:[143],&#34;width&#34;:null,&#34;valign&#34;:null,&#34;align&#34;:null,&#34;style&#34;:null},&#34;para&#34;,null]">CVSS 3.1分数</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">10.0</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">漏洞等级</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">严重</span></span></section></td></tr><tr><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">POC/EXP</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""> </span><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">已公开</span></span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf="">可利用性</span></section></td><td data-colwidth="143" width="143" style="border-color:#0080ff;"><section><span leaf=""><span textstyle="" style="color: rgb(255, 0, 0);">高</span></span></section></td></tr></tbody></table>  
  
0x03 影响版本  
  
5.0.0 <= vBulletin <=5.7.5 （使用PHP 8.1或以上 ）  
  
6.0.0  <= vBulletin <=6.0.3  （使用PHP 8.1 或以上 ）  
<table><tbody><tr style="-webkit-tap-highlight-color: transparent;outline: 0px;visibility: visible;"></tr></tbody></table>  
  
0x04 漏洞验证  
  
目前POC/EXP已经公开(后台留言：  
CVE-2025-48827，获取测试POC)  
  
概念性验证：  
  
发送数据包，出现下面的即可证明漏洞存在  
  
发送执行  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3ep5vagQIicVJdCsRoAPnLtBU1pklssnBSsKdAaEZdYGoS0MquzibTEpI2nN4SvvsasE1tgerHxH8LYA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/pl2czC0m3ep5vagQIicVJdCsRoAPnLtBUJicOMDohOXUsuDXpQWE0icHXpAhWfSfnn8KRH9w7W0zvia9zI13RxVYHg/640?wx_fmt=png&from=appmsg "")  
  
  
  
0x05 漏洞影响  
  
由于该漏洞影响范围较广，危害较大。通过以上复现过程，我们可以知道该漏洞的利用  
过程比较简单，且能造成的危害是严重的，可以执行任意代码。企业应该尽快排查是否有使用该组件，并尽快做出对应措施  
  
  
0x06 修复建议  
  
  
官方已经发布补丁修复，打补丁或升级到安全版本官方链接：  
  
https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4491049-security-patch-released-for-vbulletin-6-x-and-5-7-5?ref=blog.kevintel.com  
  
  
0X07 参考链接  
  
https://blog.kevintel.com/vbulletin-replaceadtemplate-kev/  
  
https://karmainsecurity.com/dont-call-that-protected-method-vbulletin-rce  
  
  
0x08 免责声明  
  
> 本文所涉及的任何技术、信息或工具，仅供学习和参考之用。  
  
> 请勿利用本文提供的信息从事任何违法活动或不当行为。任何因使用本文所提供的信息或工具而导致的损失、后果或不良影响，均由使用者个人承担责任，与本文作者无关。  
  
> 作者不对任何因使用本文信息或工具而产生的损失或后果承担任何责任。使用本文所提供的信息或工具即视为同意本免责声明，并承诺遵守相关法律法规和道德规范。  
  
  
  
